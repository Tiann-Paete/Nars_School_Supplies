"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/[...narsapi]";
exports.ids = ["pages/api/[...narsapi]"];
exports.modules = {

/***/ "bcrypt":
/*!*************************!*\
  !*** external "bcrypt" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("bcrypt");

/***/ }),

/***/ "jsonwebtoken":
/*!*******************************!*\
  !*** external "jsonwebtoken" ***!
  \*******************************/
/***/ ((module) => {

module.exports = require("jsonwebtoken");

/***/ }),

/***/ "mysql2/promise":
/*!*********************************!*\
  !*** external "mysql2/promise" ***!
  \*********************************/
/***/ ((module) => {

module.exports = require("mysql2/promise");

/***/ }),

/***/ "next-iron-session":
/*!************************************!*\
  !*** external "next-iron-session" ***!
  \************************************/
/***/ ((module) => {

module.exports = require("next-iron-session");

/***/ }),

/***/ "next/dist/compiled/next-server/pages-api.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/pages-api.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/pages-api.runtime.dev.js");

/***/ }),

/***/ "crypto":
/*!*************************!*\
  !*** external "crypto" ***!
  \*************************/
/***/ ((module) => {

module.exports = require("crypto");

/***/ }),

/***/ "url":
/*!**********************!*\
  !*** external "url" ***!
  \**********************/
/***/ ((module) => {

module.exports = require("url");

/***/ }),

/***/ "(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2F%5B...narsapi%5D&preferredRegion=&absolutePagePath=.%2Fsrc%5Cpages%5Capi%5C%5B...narsapi%5D.js&middlewareConfigBase64=e30%3D!":
/*!********************************************************************************************************************************************************************************************************************************************!*\
  !*** ./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2F%5B...narsapi%5D&preferredRegion=&absolutePagePath=.%2Fsrc%5Cpages%5Capi%5C%5B...narsapi%5D.js&middlewareConfigBase64=e30%3D! ***!
  \********************************************************************************************************************************************************************************************************************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   routeModule: () => (/* binding */ routeModule)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/pages-api/module.compiled */ \"(api)/./node_modules/next/dist/server/future/route-modules/pages-api/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(api)/./node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/build/templates/helpers */ \"(api)/./node_modules/next/dist/build/templates/helpers.js\");\n/* harmony import */ var _src_pages_api_narsapi_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./src\\pages\\api\\[...narsapi].js */ \"(api)/./src/pages/api/[...narsapi].js\");\n\n\n\n// Import the userland code.\n\n// Re-export the handler (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_src_pages_api_narsapi_js__WEBPACK_IMPORTED_MODULE_3__, \"default\"));\n// Re-export config.\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_src_pages_api_narsapi_js__WEBPACK_IMPORTED_MODULE_3__, \"config\");\n// Create and export the route module that will be consumed.\nconst routeModule = new next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__.PagesAPIRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES_API,\n        page: \"/api/[...narsapi]\",\n        pathname: \"/api/[...narsapi]\",\n        // The following aren't used in production.\n        bundlePath: \"\",\n        filename: \"\"\n    },\n    userland: _src_pages_api_narsapi_js__WEBPACK_IMPORTED_MODULE_3__\n});\n\n//# sourceMappingURL=pages-api.js.map//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9ub2RlX21vZHVsZXMvbmV4dC9kaXN0L2J1aWxkL3dlYnBhY2svbG9hZGVycy9uZXh0LXJvdXRlLWxvYWRlci9pbmRleC5qcz9raW5kPVBBR0VTX0FQSSZwYWdlPSUyRmFwaSUyRiU1Qi4uLm5hcnNhcGklNUQmcHJlZmVycmVkUmVnaW9uPSZhYnNvbHV0ZVBhZ2VQYXRoPS4lMkZzcmMlNUNwYWdlcyU1Q2FwaSU1QyU1Qi4uLm5hcnNhcGklNUQuanMmbWlkZGxld2FyZUNvbmZpZ0Jhc2U2ND1lMzAlM0QhIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7O0FBQXNHO0FBQ3ZDO0FBQ0w7QUFDMUQ7QUFDK0Q7QUFDL0Q7QUFDQSxpRUFBZSx3RUFBSyxDQUFDLHNEQUFRLFlBQVksRUFBQztBQUMxQztBQUNPLGVBQWUsd0VBQUssQ0FBQyxzREFBUTtBQUNwQztBQUNPLHdCQUF3QixnSEFBbUI7QUFDbEQ7QUFDQSxjQUFjLHlFQUFTO0FBQ3ZCO0FBQ0E7QUFDQTtBQUNBO0FBQ0E7QUFDQSxLQUFLO0FBQ0wsWUFBWTtBQUNaLENBQUM7O0FBRUQiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9uYXJzLz9lNDZmIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IFBhZ2VzQVBJUm91dGVNb2R1bGUgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUtbW9kdWxlcy9wYWdlcy1hcGkvbW9kdWxlLmNvbXBpbGVkXCI7XG5pbXBvcnQgeyBSb3V0ZUtpbmQgfSBmcm9tIFwibmV4dC9kaXN0L3NlcnZlci9mdXR1cmUvcm91dGUta2luZFwiO1xuaW1wb3J0IHsgaG9pc3QgfSBmcm9tIFwibmV4dC9kaXN0L2J1aWxkL3RlbXBsYXRlcy9oZWxwZXJzXCI7XG4vLyBJbXBvcnQgdGhlIHVzZXJsYW5kIGNvZGUuXG5pbXBvcnQgKiBhcyB1c2VybGFuZCBmcm9tIFwiLi9zcmNcXFxccGFnZXNcXFxcYXBpXFxcXFsuLi5uYXJzYXBpXS5qc1wiO1xuLy8gUmUtZXhwb3J0IHRoZSBoYW5kbGVyIChzaG91bGQgYmUgdGhlIGRlZmF1bHQgZXhwb3J0KS5cbmV4cG9ydCBkZWZhdWx0IGhvaXN0KHVzZXJsYW5kLCBcImRlZmF1bHRcIik7XG4vLyBSZS1leHBvcnQgY29uZmlnLlxuZXhwb3J0IGNvbnN0IGNvbmZpZyA9IGhvaXN0KHVzZXJsYW5kLCBcImNvbmZpZ1wiKTtcbi8vIENyZWF0ZSBhbmQgZXhwb3J0IHRoZSByb3V0ZSBtb2R1bGUgdGhhdCB3aWxsIGJlIGNvbnN1bWVkLlxuZXhwb3J0IGNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IFBhZ2VzQVBJUm91dGVNb2R1bGUoe1xuICAgIGRlZmluaXRpb246IHtcbiAgICAgICAga2luZDogUm91dGVLaW5kLlBBR0VTX0FQSSxcbiAgICAgICAgcGFnZTogXCIvYXBpL1suLi5uYXJzYXBpXVwiLFxuICAgICAgICBwYXRobmFtZTogXCIvYXBpL1suLi5uYXJzYXBpXVwiLFxuICAgICAgICAvLyBUaGUgZm9sbG93aW5nIGFyZW4ndCB1c2VkIGluIHByb2R1Y3Rpb24uXG4gICAgICAgIGJ1bmRsZVBhdGg6IFwiXCIsXG4gICAgICAgIGZpbGVuYW1lOiBcIlwiXG4gICAgfSxcbiAgICB1c2VybGFuZFxufSk7XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXBhZ2VzLWFwaS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2F%5B...narsapi%5D&preferredRegion=&absolutePagePath=.%2Fsrc%5Cpages%5Capi%5C%5B...narsapi%5D.js&middlewareConfigBase64=e30%3D!\n");

/***/ }),

/***/ "(api)/./src/pages/api/[...narsapi].js":
/*!***************************************!*\
  !*** ./src/pages/api/[...narsapi].js ***!
  \***************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__)\n/* harmony export */ });\n/* harmony import */ var url__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! url */ \"url\");\n/* harmony import */ var url__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(url__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var bcrypt__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! bcrypt */ \"bcrypt\");\n/* harmony import */ var bcrypt__WEBPACK_IMPORTED_MODULE_1___default = /*#__PURE__*/__webpack_require__.n(bcrypt__WEBPACK_IMPORTED_MODULE_1__);\n/* harmony import */ var jsonwebtoken__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! jsonwebtoken */ \"jsonwebtoken\");\n/* harmony import */ var jsonwebtoken__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(jsonwebtoken__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var _utils_db__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ../../utils/db */ \"(api)/./src/utils/db.js\");\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! crypto */ \"crypto\");\n/* harmony import */ var crypto__WEBPACK_IMPORTED_MODULE_4___default = /*#__PURE__*/__webpack_require__.n(crypto__WEBPACK_IMPORTED_MODULE_4__);\n/* harmony import */ var next_iron_session__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! next-iron-session */ \"next-iron-session\");\n/* harmony import */ var next_iron_session__WEBPACK_IMPORTED_MODULE_5___default = /*#__PURE__*/__webpack_require__.n(next_iron_session__WEBPACK_IMPORTED_MODULE_5__);\n\n\n\n\n\n\nconst handler = async (req, res)=>{\n    const { method } = req;\n    const { pathname } = (0,url__WEBPACK_IMPORTED_MODULE_0__.parse)(req.url, true);\n    try {\n        switch(method){\n            case \"GET\":\n                if (pathname === \"/api/check-auth\") {\n                    handleCheckAuth(req, res);\n                } else if (pathname.startsWith(\"/api/order/\")) {\n                    await handleGetOrder(req, res);\n                } else if (pathname.startsWith(\"/api/order-tracking/\")) {\n                    await handleOrderTracking(req, res);\n                } else if (pathname === \"/api/order-history\") {\n                    await handleOrderHistory(req, res);\n                } else if (pathname === \"/api/all-orders\") {\n                    await handleAllOrders(req, res);\n                } else if (pathname === \"/api/logout\") {\n                    await handleLogout(req, res);\n                } else if (pathname === \"/api/user\") {\n                    handleGetUser(req, res);\n                } else if (pathname === \"/api/products\") {\n                    await handleGetProducts(req, res);\n                } else if (pathname.startsWith(\"/api/products/category/\")) {\n                    const category = pathname.split(\"/\").pop();\n                    await handleGetProductsByCategory(req, res, category);\n                } else if (pathname === \"/api/cart\") {\n                    handleGetCart(req, res);\n                } else if (pathname === \"/api/limited-items\") {\n                    await handleGetLimitedItems(req, res);\n                } else if (pathname === \"/api/categories\") {\n                    await handleGetCategories(req, res);\n                } else if (pathname === \"/api/search\") {\n                    await handleSearch(req, res);\n                } else {\n                    res.status(404).json({\n                        error: \"Not Found\"\n                    });\n                }\n                break;\n            case \"POST\":\n                if (pathname === \"/api/signup\") {\n                    await handleSignup(req, res);\n                } else if (pathname === \"/api/signin\") {\n                    await handleSignin(req, res);\n                } else if (pathname === \"/api/place-order\") {\n                    await handlePlaceOrder(req, res);\n                } else if (pathname.startsWith(\"/api/cancel-order/\")) {\n                    await handleCancelOrder(req, res);\n                } else if (pathname.startsWith(\"/api/submit-ratings/\")) {\n                    await handleSubmitRatings(req, res);\n                } else if (pathname === \"/api/cart/add\") {\n                    handleAddToCart(req, res);\n                }\n                break;\n            case \"PUT\":\n                if (pathname === \"/api/cart/update\") {\n                    handleUpdateCart(req, res);\n                }\n                break;\n            case \"DELETE\":\n                if (pathname.startsWith(\"/api/cart/remove/\")) {\n                    handleRemoveFromCart(req, res);\n                } else if (pathname.startsWith(\"/api/cancel-order/\")) {\n                    await handleCancelOrder(req, res);\n                }\n                break;\n            default:\n                res.setHeader(\"Allow\", [\n                    \"GET\",\n                    \"POST\",\n                    \"PUT\",\n                    \"DELETE\"\n                ]);\n                res.status(405).end(`Method ${method} Not Allowed`);\n        }\n    } catch (error) {\n        console.error(error);\n        res.status(500).json({\n            error: \"An error occurred while processing your request\"\n        });\n    }\n};\nasync function handleSignup(req, res) {\n    const { firstname, lastname, address, mobile, email, password } = req.body;\n    try {\n        // Check if email already exists\n        const existingUser = await (0,_utils_db__WEBPACK_IMPORTED_MODULE_3__.query)(\"SELECT * FROM registered_users WHERE email = ?\", [\n            email\n        ]);\n        if (existingUser.length > 0) {\n            return res.status(400).json({\n                error: \"Email is already in use\"\n            });\n        }\n        // Hash the password\n        const hashedPassword = await bcrypt__WEBPACK_IMPORTED_MODULE_1___default().hash(password, 10);\n        // Insert new user\n        const result = await (0,_utils_db__WEBPACK_IMPORTED_MODULE_3__.query)(\"INSERT INTO registered_users (firstName, lastName, address, contact, email, password) VALUES (?, ?, ?, ?, ?, ?)\", [\n            firstname,\n            lastname,\n            address,\n            mobile,\n            email,\n            hashedPassword\n        ]);\n        // Insert into user_login table\n        await (0,_utils_db__WEBPACK_IMPORTED_MODULE_3__.query)(\"INSERT INTO user_login (user_firstname, user_lastname, contact, email) VALUES (?, ?, ?, ?)\", [\n            firstname,\n            lastname,\n            mobile,\n            email\n        ]);\n        // Generate JWT token\n        const token = (0,jsonwebtoken__WEBPACK_IMPORTED_MODULE_2__.sign)({\n            userId: result.insertId\n        }, process.env.JWT_SECRET, {\n            expiresIn: \"6h\"\n        });\n        res.status(200).json({\n            message: \"Signup successful\",\n            token\n        });\n    } catch (error) {\n        console.error(\"Signup error:\", error);\n        res.status(500).json({\n            error: \"An error occurred during signup\"\n        });\n    }\n}\nasync function handleSignin(req, res) {\n    const { email, password } = req.body;\n    try {\n        const users = await (0,_utils_db__WEBPACK_IMPORTED_MODULE_3__.query)(\"SELECT * FROM registered_users WHERE email = ?\", [\n            email\n        ]);\n        if (users.length === 0) {\n            return res.status(401).json({\n                success: false,\n                error: \"Invalid email or password\"\n            });\n        }\n        const user = users[0];\n        const match = await bcrypt__WEBPACK_IMPORTED_MODULE_1___default().compare(password, user.password);\n        if (!match) {\n            return res.status(401).json({\n                success: false,\n                error: \"Invalid email or password\"\n            });\n        }\n        // Generate JWT token\n        const token = (0,jsonwebtoken__WEBPACK_IMPORTED_MODULE_2__.sign)({\n            userId: user.id\n        }, process.env.JWT_SECRET, {\n            expiresIn: \"6h\"\n        });\n        // Set the user in the session\n        req.session.user = {\n            id: user.id,\n            firstName: user.firstName,\n            email: user.email\n        };\n        await req.session.save();\n        // Reset logout_time to NULL for the user\n        await (0,_utils_db__WEBPACK_IMPORTED_MODULE_3__.query)(\"UPDATE user_login SET logout_time = NULL WHERE email = ?\", [\n            email\n        ]);\n        // Update login time\n        const loginTime = new Date();\n        await (0,_utils_db__WEBPACK_IMPORTED_MODULE_3__.query)(\"UPDATE user_login SET login_time = ? WHERE email = ?\", [\n            loginTime,\n            email\n        ]);\n        // Set token in a secure, HTTP-only cookie\n        res.setHeader(\"Set-Cookie\", `authToken=${token}; HttpOnly; Path=/; Max-Age=3600; SameSite=Strict${ false ? 0 : \"\"}`);\n        res.status(200).json({\n            success: true,\n            message: \"Signin successful\",\n            token,\n            firstName: user.firstName\n        });\n    } catch (error) {\n        console.error(\"Signin error:\", error);\n        res.status(500).json({\n            success: false,\n            error: \"An error occurred during signin\"\n        });\n    }\n}\nfunction handleCheckAuth(req, res) {\n    const token = req.headers.authorization?.split(\" \")[1];\n    if (!token) {\n        return res.json({\n            isAuthenticated: false\n        });\n    }\n    try {\n        const decoded = (0,jsonwebtoken__WEBPACK_IMPORTED_MODULE_2__.verify)(token, process.env.JWT_SECRET);\n        const userId = decoded.userId;\n        // Check if the user exists in the session\n        if (req.session.user && req.session.user.id === userId) {\n            res.json({\n                isAuthenticated: true,\n                user: {\n                    id: req.session.user.id,\n                    firstName: req.session.user.firstName,\n                    email: req.session.user.email\n                }\n            });\n        } else {\n            // If the token is valid but the session doesn't exist, create it\n            // You might want to fetch user data from the database here\n            req.session.user = {\n                id: userId\n            };\n            res.json({\n                isAuthenticated: true,\n                user: {\n                    id: userId\n                }\n            });\n        }\n    } catch (error) {\n        console.error(\"Token verification error:\", error);\n        res.json({\n            isAuthenticated: false\n        });\n    }\n}\nfunction handleGetUser(req, res) {\n    const authHeader = req.headers.authorization;\n    const token = authHeader && authHeader.split(\" \")[1];\n    if (!token) {\n        console.log(\"No token provided for /api/user\");\n        return res.status(401).json({\n            success: false,\n            error: \"No token provided\"\n        });\n    }\n    try {\n        const decoded = (0,jsonwebtoken__WEBPACK_IMPORTED_MODULE_2__.verify)(token, process.env.JWT_SECRET);\n        (0,_utils_db__WEBPACK_IMPORTED_MODULE_3__.query)(\"SELECT id, firstName, email FROM registered_users WHERE id = ?\", [\n            decoded.userId\n        ]).then((users)=>{\n            if (users.length === 0) {\n                console.log(`User not found for id: ${decoded.userId}`);\n                return res.status(404).json({\n                    success: false,\n                    error: \"User not found\"\n                });\n            }\n            const user = users[0];\n            res.status(200).json({\n                success: true,\n                firstName: user.firstName,\n                email: user.email\n            });\n        }).catch((error)=>{\n            console.error(\"Database query error:\", error);\n            res.status(500).json({\n                success: false,\n                error: \"Database error\"\n            });\n        });\n    } catch (error) {\n        console.error(\"Get user error:\", error);\n        if (error.name === \"TokenExpiredError\") {\n            return res.status(401).json({\n                success: false,\n                error: \"Token expired\",\n                code: \"TOKEN_EXPIRED\"\n            });\n        }\n        res.status(401).json({\n            success: false,\n            error: \"Invalid token\"\n        });\n    }\n}\nasync function handleLogout(req, res) {\n    try {\n        const userEmail = req.headers[\"user-email\"];\n        console.log(\"Received logout request for user:\", userEmail);\n        if (userEmail) {\n            const logoutTime = new Date();\n            console.log(\"Updating logout time:\", logoutTime);\n            try {\n                const result = await (0,_utils_db__WEBPACK_IMPORTED_MODULE_3__.query)(\"UPDATE user_login SET logout_time = ? WHERE email = ? AND logout_time IS NULL\", [\n                    logoutTime,\n                    userEmail\n                ]);\n                console.log(\"Database update result:\", result);\n                if (result.affectedRows === 0) {\n                    console.log(\"No rows updated. User might not exist in user_login table or already logged out.\");\n                } else {\n                    console.log(\"Logout time updated successfully for user:\", userEmail);\n                }\n            } catch (dbError) {\n                console.error(\"Database error:\", dbError);\n                return res.status(500).json({\n                    success: false,\n                    error: \"Database error during logout\"\n                });\n            }\n        } else {\n            console.log(\"No user email provided in request headers\");\n            return res.status(400).json({\n                success: false,\n                error: \"User email not provided\"\n            });\n        }\n        res.setHeader(\"Set-Cookie\", \"authToken=; HttpOnly; Path=/; Max-Age=0; SameSite=Strict\");\n        res.status(200).json({\n            success: true,\n            message: \"Logout successful\"\n        });\n    } catch (error) {\n        console.error(\"Logout error:\", error);\n        res.status(500).json({\n            success: false,\n            error: \"An error occurred during logout\"\n        });\n    }\n}\nasync function handleSearch(req, res) {\n    const { query: searchQuery } = (0,url__WEBPACK_IMPORTED_MODULE_0__.parse)(req.url, true).query;\n    if (!searchQuery) {\n        return res.status(400).json({\n            error: \"Search query is required\"\n        });\n    }\n    try {\n        const searchTerms = searchQuery.split(/\\s+/).map((term)=>`%${term}%`);\n        const placeholders = searchTerms.map(()=>\"(p.name LIKE ? OR p.category LIKE ?)\").join(\" AND \");\n        const sql = `\r\n        SELECT p.*, \r\n               COALESCE(AVG(pr.rating), 5) as avg_rating,\r\n               COUNT(pr.id) as rating_count\r\n        FROM products p\r\n        LEFT JOIN product_ratings pr ON p.id = pr.product_id\r\n        WHERE p.deleted = 0 AND (${placeholders})\r\n        GROUP BY p.id\r\n      `;\n        // Double the searchTerms array to account for both name and category\n        const params = searchTerms.flatMap((term)=>[\n                term,\n                term\n            ]);\n        const results = await (0,_utils_db__WEBPACK_IMPORTED_MODULE_3__.query)(sql, params);\n        res.status(200).json(results);\n    } catch (error) {\n        console.error(\"Error searching products:\", error);\n        res.status(500).json({\n            error: \"An error occurred while searching products\",\n            details: error.message\n        });\n    }\n}\nasync function handleGetProducts(req, res) {\n    try {\n        const productsQuery = `\r\n      SELECT p.*, \r\n             COALESCE(AVG(pr.rating), 5) as avg_rating,\r\n             COUNT(pr.id) as rating_count\r\n      FROM products p\r\n      LEFT JOIN product_ratings pr ON p.id = pr.product_id\r\n      WHERE p.deleted = 0\r\n      GROUP BY p.id\r\n    `;\n        const products = await (0,_utils_db__WEBPACK_IMPORTED_MODULE_3__.query)(productsQuery);\n        res.status(200).json(products);\n    } catch (error) {\n        console.error(\"Error fetching products:\", error);\n        res.status(500).json({\n            error: \"An error occurred while fetching products\",\n            details: error.message\n        });\n    }\n}\nasync function handleGetProductsByCategory(req, res, category) {\n    try {\n        const decodedCategory = decodeURIComponent(category);\n        console.log(`Attempting to fetch products for category: ${decodedCategory}`);\n        const productsQuery = `\r\n      SELECT p.*, \r\n             COALESCE(AVG(pr.rating), 5) as avg_rating,\r\n             COUNT(pr.id) as rating_count\r\n      FROM products p\r\n      LEFT JOIN product_ratings pr ON p.id = pr.product_id\r\n      WHERE p.category = ? AND p.deleted = 0\r\n      GROUP BY p.id\r\n    `;\n        const products = await (0,_utils_db__WEBPACK_IMPORTED_MODULE_3__.query)(productsQuery, [\n            decodedCategory\n        ]);\n        console.log(`Fetched ${products.length} products for category: ${decodedCategory}`);\n        res.status(200).json(products);\n    } catch (error) {\n        console.error(\"Error fetching products by category:\", error);\n        res.status(500).json({\n            error: \"An error occurred while fetching products by category\",\n            details: error.message,\n            stack: error.stack\n        });\n    }\n}\nasync function handleGetLimitedItems(req, res) {\n    try {\n        console.log(\"Attempting to fetch limited items\");\n        const limitedItemsQuery = `\r\n      SELECT p.*, \r\n             COALESCE(AVG(pr.rating), 5) as avg_rating,\r\n             COUNT(pr.id) as rating_count\r\n      FROM products p\r\n      LEFT JOIN product_ratings pr ON p.id = pr.product_id\r\n      WHERE p.category = 'Limited Items' AND p.deleted = 0\r\n      GROUP BY p.id\r\n    `;\n        const limitedItems = await (0,_utils_db__WEBPACK_IMPORTED_MODULE_3__.query)(limitedItemsQuery);\n        console.log(\"Query result:\", limitedItems);\n        res.status(200).json(limitedItems);\n    } catch (error) {\n        console.error(\"Error fetching limited items:\", error);\n        res.status(500).json({\n            error: \"An error occurred while fetching limited items\",\n            details: error.message,\n            stack: error.stack\n        });\n    }\n}\nasync function handleGetCategories(req, res) {\n    try {\n        const categories = await (0,_utils_db__WEBPACK_IMPORTED_MODULE_3__.query)(`\r\n        SELECT DISTINCT category \r\n        FROM products \r\n        WHERE deleted = 0 AND category != 'Limited'\r\n      `);\n        const formattedCategories = categories.map((item)=>({\n                id: item.category,\n                name: item.category\n            }));\n        res.status(200).json(formattedCategories);\n    } catch (error) {\n        console.error(\"Error fetching categories:\", error);\n        res.status(500).json({\n            error: \"An error occurred while fetching categories\",\n            details: error.message\n        });\n    }\n}\nasync function handlePlaceOrder(req, res) {\n    const authHeader = req.headers.authorization;\n    if (!authHeader) {\n        console.log(\"No Authorization header found\");\n        return res.status(401).json({\n            error: \"No token provided\"\n        });\n    }\n    const token = authHeader.split(\" \")[1];\n    if (!token) {\n        console.log(\"Token not found in Authorization header\");\n        return res.status(401).json({\n            error: \"No token provided\"\n        });\n    }\n    try {\n        const decoded = (0,jsonwebtoken__WEBPACK_IMPORTED_MODULE_2__.verify)(token, process.env.JWT_SECRET);\n        const userId = decoded.userId;\n        const { billingInfo, paymentMethod, cartItems, subtotal, delivery, total } = req.body;\n        const trackingNumber = crypto__WEBPACK_IMPORTED_MODULE_4___default().randomBytes(8).toString(\"hex\").toUpperCase();\n        await (0,_utils_db__WEBPACK_IMPORTED_MODULE_3__.query)(\"START TRANSACTION\");\n        // Insert the order\n        const orderResult = await (0,_utils_db__WEBPACK_IMPORTED_MODULE_3__.query)(\"INSERT INTO orders (user_id, full_name, phone_number, address, city, state_province, postal_code, delivery_address, payment_method, subtotal, delivery_fee, total, tracking_number, status) VALUES (?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?, ?)\", [\n            userId,\n            billingInfo.fullName,\n            billingInfo.phoneNumber,\n            billingInfo.address,\n            billingInfo.city,\n            billingInfo.stateProvince,\n            billingInfo.postalCode,\n            billingInfo.deliveryAddress,\n            paymentMethod,\n            subtotal,\n            delivery,\n            total,\n            trackingNumber,\n            \"Order Placed\"\n        ]);\n        const orderId = orderResult.insertId;\n        // Insert ordered products and update stock quantity\n        for (const item of cartItems){\n            // Check if there's enough stock before placing the order\n            const [product] = await (0,_utils_db__WEBPACK_IMPORTED_MODULE_3__.query)(\"SELECT stock_quantity FROM products WHERE id = ?\", [\n                item.id\n            ]);\n            if (!product || product.stock_quantity < item.quantity) {\n                await (0,_utils_db__WEBPACK_IMPORTED_MODULE_3__.query)(\"ROLLBACK\");\n                return res.status(400).json({\n                    error: `Not enough stock for product: ${item.name}`\n                });\n            }\n            await (0,_utils_db__WEBPACK_IMPORTED_MODULE_3__.query)(\"INSERT INTO ordered_products (name, product_id, order_id, quantity, price) VALUES (?, ?, ?, ?, ?)\", [\n                item.name,\n                item.id,\n                orderId,\n                item.quantity,\n                item.price\n            ]);\n            // Update stock quantity\n            const updateResult = await (0,_utils_db__WEBPACK_IMPORTED_MODULE_3__.query)(\"UPDATE products SET stock_quantity = stock_quantity - ? WHERE id = ?\", [\n                item.quantity,\n                item.id\n            ]);\n            if (updateResult.affectedRows === 0) {\n                // If no rows were updated, it means there's not enough stock\n                await (0,_utils_db__WEBPACK_IMPORTED_MODULE_3__.query)(\"ROLLBACK\");\n                return res.status(400).json({\n                    error: `Not enough stock for product: ${item.name}`\n                });\n            }\n        }\n        await (0,_utils_db__WEBPACK_IMPORTED_MODULE_3__.query)(\"COMMIT\");\n        res.json({\n            success: true,\n            orderId,\n            trackingNumber\n        });\n    } catch (error) {\n        await (0,_utils_db__WEBPACK_IMPORTED_MODULE_3__.query)(\"ROLLBACK\");\n        console.error(\"Error placing order:\", error);\n        if (error.name === \"JsonWebTokenError\") {\n            return res.status(401).json({\n                error: \"Invalid token\"\n            });\n        }\n        res.status(500).json({\n            error: \"An error occurred while placing the order\"\n        });\n    }\n}\nasync function handleGetOrder(req, res) {\n    const authHeader = req.headers.authorization;\n    if (!authHeader) {\n        return res.status(401).json({\n            error: \"No token provided\"\n        });\n    }\n    const token = authHeader.split(\" \")[1];\n    if (!token) {\n        return res.status(401).json({\n            error: \"No token provided\"\n        });\n    }\n    try {\n        const decoded = (0,jsonwebtoken__WEBPACK_IMPORTED_MODULE_2__.verify)(token, process.env.JWT_SECRET);\n        const userId = decoded.userId;\n        const orderId = req.query.orderId || req.url.split(\"/\").pop();\n        const results = await (0,_utils_db__WEBPACK_IMPORTED_MODULE_3__.query)(`\r\n        SELECT o.*, op.name, op.product_id, op.quantity, op.price, p.image_url\r\n        FROM orders o\r\n        JOIN ordered_products op ON o.id = op.order_id\r\n        JOIN products p ON op.product_id = p.id\r\n        WHERE o.id = ? AND o.user_id = ?\r\n      `, [\n            orderId,\n            userId\n        ]);\n        if (results.length === 0) {\n            return res.status(404).json({\n                error: \"Order not found\"\n            });\n        }\n        const orderDetails = {\n            orderId: results[0].id,\n            trackingNumber: results[0].tracking_number,\n            status: results[0].status,\n            billingInfo: {\n                fullName: results[0].full_name,\n                phoneNumber: results[0].phone_number,\n                address: results[0].address,\n                city: results[0].city,\n                stateProvince: results[0].state_province,\n                postalCode: results[0].postal_code,\n                deliveryAddress: results[0].delivery_address\n            },\n            paymentMethod: results[0].payment_method,\n            items: results.map((item)=>({\n                    id: item.product_id,\n                    name: item.name,\n                    quantity: item.quantity,\n                    price: item.price,\n                    imageUrl: item.image_url\n                })),\n            subtotal: results[0].subtotal,\n            delivery: results[0].delivery_fee,\n            total: results[0].total\n        };\n        res.json(orderDetails);\n    } catch (error) {\n        console.error(\"Error fetching order details:\", error);\n        if (error.name === \"JsonWebTokenError\") {\n            return res.status(401).json({\n                error: \"Invalid token\"\n            });\n        }\n        res.status(500).json({\n            error: \"An error occurred while fetching order details\"\n        });\n    }\n}\nasync function handleAllOrders(req, res) {\n    const authHeader = req.headers.authorization;\n    if (!authHeader) {\n        return res.status(401).json({\n            error: \"No token provided\"\n        });\n    }\n    const token = authHeader.split(\" \")[1];\n    if (!token) {\n        return res.status(401).json({\n            error: \"No token provided\"\n        });\n    }\n    try {\n        const decoded = (0,jsonwebtoken__WEBPACK_IMPORTED_MODULE_2__.verify)(token, process.env.JWT_SECRET);\n        const userId = decoded.userId;\n        const orders = await (0,_utils_db__WEBPACK_IMPORTED_MODULE_3__.query)(`\r\n        SELECT id, tracking_number, status, order_date, total\r\n        FROM orders\r\n        WHERE user_id = ?\r\n        ORDER BY order_date DESC\r\n      `, [\n            userId\n        ]);\n        res.status(200).json(orders);\n    } catch (error) {\n        if (error.name === \"JsonWebTokenError\") {\n            return res.status(401).json({\n                error: \"Invalid token\"\n            });\n        }\n        console.error(\"Error fetching all orders:\", error);\n        res.status(500).json({\n            error: \"An error occurred while fetching orders\",\n            details: error.message\n        });\n    }\n}\nasync function handleCancelOrder(req, res) {\n    const authHeader = req.headers.authorization;\n    if (!authHeader) {\n        return res.status(401).json({\n            error: \"No token provided\"\n        });\n    }\n    const token = authHeader.split(\" \")[1];\n    if (!token) {\n        return res.status(401).json({\n            error: \"No token provided\"\n        });\n    }\n    try {\n        const decoded = (0,jsonwebtoken__WEBPACK_IMPORTED_MODULE_2__.verify)(token, process.env.JWT_SECRET);\n        const userId = decoded.userId;\n        const orderId = req.url.split(\"/\").pop();\n        const result = await (0,_utils_db__WEBPACK_IMPORTED_MODULE_3__.query)(`\r\n        UPDATE orders\r\n        SET status = 'Cancelled'\r\n        WHERE id = ? AND user_id = ? AND status = 'Order Placed'\r\n      `, [\n            orderId,\n            userId\n        ]);\n        if (result.affectedRows === 0) {\n            return res.status(400).json({\n                error: \"Order not found or cannot be cancelled\"\n            });\n        }\n        res.json({\n            success: true,\n            message: \"Order cancelled successfully\"\n        });\n    } catch (error) {\n        if (error.name === \"JsonWebTokenError\") {\n            return res.status(401).json({\n                error: \"Invalid token\"\n            });\n        }\n        console.error(\"Error cancelling order:\", error);\n        res.status(500).json({\n            error: \"An error occurred while cancelling the order\"\n        });\n    }\n}\nasync function handleOrderHistory(req, res) {\n    const authHeader = req.headers.authorization;\n    if (!authHeader) {\n        return res.status(401).json({\n            error: \"No token provided\"\n        });\n    }\n    const token = authHeader.split(\" \")[1];\n    if (!token) {\n        return res.status(401).json({\n            error: \"No token provided\"\n        });\n    }\n    try {\n        const decoded = (0,jsonwebtoken__WEBPACK_IMPORTED_MODULE_2__.verify)(token, process.env.JWT_SECRET);\n        const userId = decoded.userId;\n        const orders = await (0,_utils_db__WEBPACK_IMPORTED_MODULE_3__.query)(`\r\n        SELECT o.id, o.tracking_number, o.status, o.order_date, o.total, o.is_rated,\r\n               GROUP_CONCAT(op.name SEPARATOR ', ') AS products\r\n        FROM orders o\r\n        JOIN ordered_products op ON o.id = op.order_id\r\n        WHERE o.user_id = ?\r\n        GROUP BY o.id\r\n        ORDER BY o.order_date DESC\r\n      `, [\n            userId\n        ]);\n        res.status(200).json(orders);\n    } catch (error) {\n        if (error.name === \"JsonWebTokenError\") {\n            return res.status(401).json({\n                error: \"Invalid token\"\n            });\n        }\n        console.error(\"Error fetching order history:\", error);\n        res.status(500).json({\n            error: \"An error occurred while fetching order history\",\n            details: error.message\n        });\n    }\n}\nasync function handleSubmitRatings(req, res) {\n    const authHeader = req.headers.authorization;\n    if (!authHeader) {\n        return res.status(401).json({\n            error: \"No token provided\"\n        });\n    }\n    const token = authHeader.split(\" \")[1];\n    if (!token) {\n        return res.status(401).json({\n            error: \"No token provided\"\n        });\n    }\n    try {\n        const decoded = (0,jsonwebtoken__WEBPACK_IMPORTED_MODULE_2__.verify)(token, process.env.JWT_SECRET);\n        const userId = decoded.userId;\n        const orderId = req.url.split(\"/\").pop();\n        const { ratings, feedback } = req.body;\n        // Verify that the order belongs to the user\n        const orderCheck = await (0,_utils_db__WEBPACK_IMPORTED_MODULE_3__.query)(\"SELECT id FROM orders WHERE id = ? AND user_id = ?\", [\n            orderId,\n            userId\n        ]);\n        if (orderCheck.length === 0) {\n            return res.status(403).json({\n                error: \"Unauthorized to rate this order\"\n            });\n        }\n        // Start a transaction\n        await (0,_utils_db__WEBPACK_IMPORTED_MODULE_3__.query)(\"START TRANSACTION\");\n        try {\n            // Insert ratings for each product\n            for (const [productId, rating] of Object.entries(ratings)){\n                await (0,_utils_db__WEBPACK_IMPORTED_MODULE_3__.query)(\"INSERT INTO product_ratings (order_id, product_id, rating) VALUES (?, ?, ?)\", [\n                    orderId,\n                    productId,\n                    rating\n                ]);\n            }\n            // Insert feedback\n            if (feedback) {\n                await (0,_utils_db__WEBPACK_IMPORTED_MODULE_3__.query)(\"INSERT INTO order_feedback (order_id, feedback) VALUES (?, ?)\", [\n                    orderId,\n                    feedback\n                ]);\n            }\n            // Update the order to mark it as rated\n            await (0,_utils_db__WEBPACK_IMPORTED_MODULE_3__.query)(\"UPDATE orders SET is_rated = 1 WHERE id = ?\", [\n                orderId\n            ]);\n            // Commit the transaction\n            await (0,_utils_db__WEBPACK_IMPORTED_MODULE_3__.query)(\"COMMIT\");\n            res.status(200).json({\n                success: true,\n                message: \"Ratings submitted successfully\"\n            });\n        } catch (error) {\n            // If there's an error, rollback the transaction\n            await (0,_utils_db__WEBPACK_IMPORTED_MODULE_3__.query)(\"ROLLBACK\");\n            throw error;\n        }\n    } catch (error) {\n        if (error.name === \"JsonWebTokenError\") {\n            return res.status(401).json({\n                error: \"Invalid token\"\n            });\n        }\n        console.error(\"Error submitting ratings:\", error);\n        res.status(500).json({\n            error: \"An error occurred while submitting ratings\",\n            details: error.message\n        });\n    }\n}\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_iron_session__WEBPACK_IMPORTED_MODULE_5__.withIronSession)(handler, {\n    password: process.env.SESSION_PASSWORD,\n    cookieName: \"nars_session\",\n    cookieOptions: {\n        secure: \"development\" === \"production\",\n        sameSite: \"strict\",\n        httpOnly: true\n    }\n}));\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,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QUFPO1lBQThDbUUsU0FBU25FLE1BQU0rQixPQUFPO1FBQUM7SUFDckc7QUFDRjtBQVNBLGlFQUFlekQsa0VBQWVBLENBQUNDLFNBQVM7SUFDdEMwQyxVQUFVVSxRQUFRQyxHQUFHLENBQUM4RixnQkFBZ0I7SUFDdENDLFlBQVk7SUFDWkMsZUFBZTtRQUNiQyxRQUFRbEcsa0JBQXlCO1FBQ2pDbUcsVUFBVTtRQUNWQyxVQUFVO0lBQ1o7QUFDRixFQUFFLEVBQUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9uYXJzLy4vc3JjL3BhZ2VzL2FwaS9bLi4ubmFyc2FwaV0uanM/NzI0NiJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBwYXJzZSB9IGZyb20gJ3VybCc7XHJcbmltcG9ydCBiY3J5cHQgZnJvbSAnYmNyeXB0JztcclxuaW1wb3J0IHsgc2lnbiwgdmVyaWZ5IH0gZnJvbSAnanNvbndlYnRva2VuJztcclxuaW1wb3J0IHsgcXVlcnkgfSBmcm9tICcuLi8uLi91dGlscy9kYic7XHJcbmltcG9ydCBjcnlwdG8gZnJvbSAnY3J5cHRvJztcclxuaW1wb3J0IHsgd2l0aElyb25TZXNzaW9uIH0gZnJvbSAnbmV4dC1pcm9uLXNlc3Npb24nO1xyXG5cclxuY29uc3QgaGFuZGxlciA9IGFzeW5jIChyZXEsIHJlcykgPT4ge1xyXG4gICAgY29uc3QgeyBtZXRob2QgfSA9IHJlcTtcclxuICAgIGNvbnN0IHsgcGF0aG5hbWUgfSA9IHBhcnNlKHJlcS51cmwsIHRydWUpO1xyXG5cclxuICAgIHRyeSB7XHJcbiAgICAgIHN3aXRjaCAobWV0aG9kKSB7XHJcbiAgICAgICAgY2FzZSAnR0VUJzpcclxuICAgICAgICAgIGlmIChwYXRobmFtZSA9PT0gJy9hcGkvY2hlY2stYXV0aCcpIHtcclxuICAgICAgICAgICAgaGFuZGxlQ2hlY2tBdXRoKHJlcSwgcmVzKTtcclxuICAgICAgICAgIH0gZWxzZSBpZiAocGF0aG5hbWUuc3RhcnRzV2l0aCgnL2FwaS9vcmRlci8nKSkge1xyXG4gICAgICAgICAgICBhd2FpdCBoYW5kbGVHZXRPcmRlcihyZXEsIHJlcyk7XHJcbiAgICAgICAgICB9IGVsc2UgaWYgKHBhdGhuYW1lLnN0YXJ0c1dpdGgoJy9hcGkvb3JkZXItdHJhY2tpbmcvJykpIHtcclxuICAgICAgICAgICAgYXdhaXQgaGFuZGxlT3JkZXJUcmFja2luZyhyZXEsIHJlcyk7XHJcbiAgICAgICAgICB9IGVsc2UgaWYgKHBhdGhuYW1lID09PSAnL2FwaS9vcmRlci1oaXN0b3J5Jykge1xyXG4gICAgICAgICAgICBhd2FpdCBoYW5kbGVPcmRlckhpc3RvcnkocmVxLCByZXMpO1xyXG4gICAgICAgICAgfSBlbHNlIGlmIChwYXRobmFtZSA9PT0gJy9hcGkvYWxsLW9yZGVycycpIHtcclxuICAgICAgICAgICAgYXdhaXQgaGFuZGxlQWxsT3JkZXJzKHJlcSwgcmVzKTtcclxuICAgICAgICAgIH0gZWxzZSBpZiAocGF0aG5hbWUgPT09ICcvYXBpL2xvZ291dCcpIHtcclxuICAgICAgICAgICAgYXdhaXQgaGFuZGxlTG9nb3V0KHJlcSwgcmVzKTtcclxuICAgICAgICAgIH0gZWxzZSBpZiAocGF0aG5hbWUgPT09ICcvYXBpL3VzZXInKSB7XHJcbiAgICAgICAgICAgIGhhbmRsZUdldFVzZXIocmVxLCByZXMpO1xyXG4gICAgICAgICAgfSBlbHNlIGlmIChwYXRobmFtZSA9PT0gJy9hcGkvcHJvZHVjdHMnKSB7XHJcbiAgICAgICAgICAgIGF3YWl0IGhhbmRsZUdldFByb2R1Y3RzKHJlcSwgcmVzKTtcclxuICAgICAgICAgIH0gZWxzZSBpZiAocGF0aG5hbWUuc3RhcnRzV2l0aCgnL2FwaS9wcm9kdWN0cy9jYXRlZ29yeS8nKSkge1xyXG4gICAgICAgICAgICBjb25zdCBjYXRlZ29yeSA9IHBhdGhuYW1lLnNwbGl0KCcvJykucG9wKCk7XHJcbiAgICAgICAgICAgIGF3YWl0IGhhbmRsZUdldFByb2R1Y3RzQnlDYXRlZ29yeShyZXEsIHJlcywgY2F0ZWdvcnkpO1xyXG4gICAgICAgICAgfSBlbHNlIGlmIChwYXRobmFtZSA9PT0gJy9hcGkvY2FydCcpIHtcclxuICAgICAgICAgICAgaGFuZGxlR2V0Q2FydChyZXEsIHJlcyk7XHJcbiAgICAgICAgICB9IGVsc2UgaWYgKHBhdGhuYW1lID09PSAnL2FwaS9saW1pdGVkLWl0ZW1zJykge1xyXG4gICAgICAgICAgICBhd2FpdCBoYW5kbGVHZXRMaW1pdGVkSXRlbXMocmVxLCByZXMpO1xyXG4gICAgICAgICAgfSBlbHNlIGlmIChwYXRobmFtZSA9PT0gJy9hcGkvY2F0ZWdvcmllcycpIHtcclxuICAgICAgICAgICAgYXdhaXQgaGFuZGxlR2V0Q2F0ZWdvcmllcyhyZXEsIHJlcyk7XHJcbiAgICAgICAgICB9IGVsc2UgaWYgKHBhdGhuYW1lID09PSAnL2FwaS9zZWFyY2gnKSB7XHJcbiAgICAgICAgICAgIGF3YWl0IGhhbmRsZVNlYXJjaChyZXEsIHJlcyk7XHJcbiAgICAgICAgICB9IGVsc2Uge1xyXG4gICAgICAgICAgICByZXMuc3RhdHVzKDQwNCkuanNvbih7IGVycm9yOiAnTm90IEZvdW5kJyB9KTtcclxuICAgICAgICAgIH1cclxuICAgICAgICAgIGJyZWFrO1xyXG4gICAgXHJcbiAgICAgICAgICBjYXNlICdQT1NUJzpcclxuICAgICAgICAgICAgaWYgKHBhdGhuYW1lID09PSAnL2FwaS9zaWdudXAnKSB7XHJcbiAgICAgICAgICAgICAgYXdhaXQgaGFuZGxlU2lnbnVwKHJlcSwgcmVzKTtcclxuICAgICAgICAgICAgfSBlbHNlIGlmIChwYXRobmFtZSA9PT0gJy9hcGkvc2lnbmluJykge1xyXG4gICAgICAgICAgICAgIGF3YWl0IGhhbmRsZVNpZ25pbihyZXEsIHJlcyk7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAocGF0aG5hbWUgPT09ICcvYXBpL3BsYWNlLW9yZGVyJykge1xyXG4gICAgICAgICAgICAgIGF3YWl0IGhhbmRsZVBsYWNlT3JkZXIocmVxLCByZXMpO1xyXG4gICAgICAgICAgICB9ICBlbHNlIGlmIChwYXRobmFtZS5zdGFydHNXaXRoKCcvYXBpL2NhbmNlbC1vcmRlci8nKSkge1xyXG4gICAgICAgICAgICAgICAgYXdhaXQgaGFuZGxlQ2FuY2VsT3JkZXIocmVxLCByZXMpO1xyXG4gICAgICAgICAgICB9IGVsc2UgaWYgKHBhdGhuYW1lLnN0YXJ0c1dpdGgoJy9hcGkvc3VibWl0LXJhdGluZ3MvJykpIHtcclxuICAgICAgICAgICAgICBhd2FpdCBoYW5kbGVTdWJtaXRSYXRpbmdzKHJlcSwgcmVzKTtcclxuICAgICAgICAgICAgfSBlbHNlIGlmIChwYXRobmFtZSA9PT0gJy9hcGkvY2FydC9hZGQnKSB7XHJcbiAgICAgICAgICAgICAgaGFuZGxlQWRkVG9DYXJ0KHJlcSwgcmVzKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBicmVhaztcclxuICAgIFxyXG4gICAgICAgICAgY2FzZSAnUFVUJzpcclxuICAgICAgICAgICAgaWYgKHBhdGhuYW1lID09PSAnL2FwaS9jYXJ0L3VwZGF0ZScpIHtcclxuICAgICAgICAgICAgICBoYW5kbGVVcGRhdGVDYXJ0KHJlcSwgcmVzKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBicmVhaztcclxuICAgIFxyXG4gICAgICAgICAgY2FzZSAnREVMRVRFJzpcclxuICAgICAgICAgICAgaWYgKHBhdGhuYW1lLnN0YXJ0c1dpdGgoJy9hcGkvY2FydC9yZW1vdmUvJykpIHtcclxuICAgICAgICAgICAgICBoYW5kbGVSZW1vdmVGcm9tQ2FydChyZXEsIHJlcyk7XHJcbiAgICAgICAgICAgIH0gZWxzZSBpZiAocGF0aG5hbWUuc3RhcnRzV2l0aCgnL2FwaS9jYW5jZWwtb3JkZXIvJykpIHtcclxuICAgICAgICAgICAgICBhd2FpdCBoYW5kbGVDYW5jZWxPcmRlcihyZXEsIHJlcyk7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgYnJlYWs7XHJcbiAgICBcclxuICAgICAgICAgIGRlZmF1bHQ6XHJcbiAgICAgICAgICAgIHJlcy5zZXRIZWFkZXIoJ0FsbG93JywgWydHRVQnLCAnUE9TVCcsICdQVVQnLCAnREVMRVRFJ10pO1xyXG4gICAgICAgICAgICByZXMuc3RhdHVzKDQwNSkuZW5kKGBNZXRob2QgJHttZXRob2R9IE5vdCBBbGxvd2VkYCk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICAgIGNvbnNvbGUuZXJyb3IoZXJyb3IpO1xyXG4gICAgICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgZXJyb3I6ICdBbiBlcnJvciBvY2N1cnJlZCB3aGlsZSBwcm9jZXNzaW5nIHlvdXIgcmVxdWVzdCcgfSk7XHJcbiAgICAgIH1cclxuICAgIH1cclxuXHJcbmFzeW5jIGZ1bmN0aW9uIGhhbmRsZVNpZ251cChyZXEsIHJlcykge1xyXG4gIGNvbnN0IHsgZmlyc3RuYW1lLCBsYXN0bmFtZSwgYWRkcmVzcywgbW9iaWxlLCBlbWFpbCwgcGFzc3dvcmQgfSA9IHJlcS5ib2R5O1xyXG5cclxuICB0cnkge1xyXG4gICAgLy8gQ2hlY2sgaWYgZW1haWwgYWxyZWFkeSBleGlzdHNcclxuICAgIGNvbnN0IGV4aXN0aW5nVXNlciA9IGF3YWl0IHF1ZXJ5KCdTRUxFQ1QgKiBGUk9NIHJlZ2lzdGVyZWRfdXNlcnMgV0hFUkUgZW1haWwgPSA/JywgW2VtYWlsXSk7XHJcbiAgICBpZiAoZXhpc3RpbmdVc2VyLmxlbmd0aCA+IDApIHtcclxuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5qc29uKHsgZXJyb3I6ICdFbWFpbCBpcyBhbHJlYWR5IGluIHVzZScgfSk7XHJcbiAgICB9XHJcbiAgICAvLyBIYXNoIHRoZSBwYXNzd29yZFxyXG4gICAgY29uc3QgaGFzaGVkUGFzc3dvcmQgPSBhd2FpdCBiY3J5cHQuaGFzaChwYXNzd29yZCwgMTApO1xyXG4gICAgLy8gSW5zZXJ0IG5ldyB1c2VyXHJcbiAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBxdWVyeShcclxuICAgICAgJ0lOU0VSVCBJTlRPIHJlZ2lzdGVyZWRfdXNlcnMgKGZpcnN0TmFtZSwgbGFzdE5hbWUsIGFkZHJlc3MsIGNvbnRhY3QsIGVtYWlsLCBwYXNzd29yZCkgVkFMVUVTICg/LCA/LCA/LCA/LCA/LCA/KScsXHJcbiAgICAgIFtmaXJzdG5hbWUsIGxhc3RuYW1lLCBhZGRyZXNzLCBtb2JpbGUsIGVtYWlsLCBoYXNoZWRQYXNzd29yZF1cclxuICAgICk7XHJcbiAgICAvLyBJbnNlcnQgaW50byB1c2VyX2xvZ2luIHRhYmxlXHJcbiAgICBhd2FpdCBxdWVyeShcclxuICAgICAgJ0lOU0VSVCBJTlRPIHVzZXJfbG9naW4gKHVzZXJfZmlyc3RuYW1lLCB1c2VyX2xhc3RuYW1lLCBjb250YWN0LCBlbWFpbCkgVkFMVUVTICg/LCA/LCA/LCA/KScsXHJcbiAgICAgIFtmaXJzdG5hbWUsIGxhc3RuYW1lLCBtb2JpbGUsIGVtYWlsXVxyXG4gICAgKTtcclxuICAgIC8vIEdlbmVyYXRlIEpXVCB0b2tlblxyXG4gICAgY29uc3QgdG9rZW4gPSBzaWduKHsgdXNlcklkOiByZXN1bHQuaW5zZXJ0SWQgfSwgcHJvY2Vzcy5lbnYuSldUX1NFQ1JFVCwgeyBleHBpcmVzSW46ICc2aCcgfSk7XHJcbiAgICByZXMuc3RhdHVzKDIwMCkuanNvbih7IG1lc3NhZ2U6ICdTaWdudXAgc3VjY2Vzc2Z1bCcsIHRva2VuIH0pO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdTaWdudXAgZXJyb3I6JywgZXJyb3IpO1xyXG4gICAgcmVzLnN0YXR1cyg1MDApLmpzb24oeyBlcnJvcjogJ0FuIGVycm9yIG9jY3VycmVkIGR1cmluZyBzaWdudXAnIH0pO1xyXG4gIH1cclxufVxyXG5cclxuYXN5bmMgZnVuY3Rpb24gaGFuZGxlU2lnbmluKHJlcSwgcmVzKSB7XHJcbiAgY29uc3QgeyBlbWFpbCwgcGFzc3dvcmQgfSA9IHJlcS5ib2R5O1xyXG5cclxuICB0cnkge1xyXG4gICAgY29uc3QgdXNlcnMgPSBhd2FpdCBxdWVyeSgnU0VMRUNUICogRlJPTSByZWdpc3RlcmVkX3VzZXJzIFdIRVJFIGVtYWlsID0gPycsIFtlbWFpbF0pO1xyXG5cclxuICAgIGlmICh1c2Vycy5sZW5ndGggPT09IDApIHtcclxuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAxKS5qc29uKHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiAnSW52YWxpZCBlbWFpbCBvciBwYXNzd29yZCcgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgY29uc3QgdXNlciA9IHVzZXJzWzBdO1xyXG4gICAgY29uc3QgbWF0Y2ggPSBhd2FpdCBiY3J5cHQuY29tcGFyZShwYXNzd29yZCwgdXNlci5wYXNzd29yZCk7XHJcblxyXG4gICAgaWYgKCFtYXRjaCkge1xyXG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDEpLmpzb24oeyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6ICdJbnZhbGlkIGVtYWlsIG9yIHBhc3N3b3JkJyB9KTtcclxuICAgIH1cclxuXHJcbiAgICAvLyBHZW5lcmF0ZSBKV1QgdG9rZW5cclxuICAgIGNvbnN0IHRva2VuID0gc2lnbih7IHVzZXJJZDogdXNlci5pZCB9LCBwcm9jZXNzLmVudi5KV1RfU0VDUkVULCB7IGV4cGlyZXNJbjogJzZoJyB9KTtcclxuXHJcbiAgICAvLyBTZXQgdGhlIHVzZXIgaW4gdGhlIHNlc3Npb25cclxuICAgIHJlcS5zZXNzaW9uLnVzZXIgPSB7XHJcbiAgICAgIGlkOiB1c2VyLmlkLFxyXG4gICAgICBmaXJzdE5hbWU6IHVzZXIuZmlyc3ROYW1lLFxyXG4gICAgICBlbWFpbDogdXNlci5lbWFpbFxyXG4gICAgfTtcclxuICAgIGF3YWl0IHJlcS5zZXNzaW9uLnNhdmUoKTtcclxuXHJcbiAgICAvLyBSZXNldCBsb2dvdXRfdGltZSB0byBOVUxMIGZvciB0aGUgdXNlclxyXG4gICAgYXdhaXQgcXVlcnkoJ1VQREFURSB1c2VyX2xvZ2luIFNFVCBsb2dvdXRfdGltZSA9IE5VTEwgV0hFUkUgZW1haWwgPSA/JywgW2VtYWlsXSk7XHJcblxyXG4gICAgLy8gVXBkYXRlIGxvZ2luIHRpbWVcclxuICAgIGNvbnN0IGxvZ2luVGltZSA9IG5ldyBEYXRlKCk7XHJcbiAgICBhd2FpdCBxdWVyeSgnVVBEQVRFIHVzZXJfbG9naW4gU0VUIGxvZ2luX3RpbWUgPSA/IFdIRVJFIGVtYWlsID0gPycsIFtsb2dpblRpbWUsIGVtYWlsXSk7XHJcblxyXG4gICAgLy8gU2V0IHRva2VuIGluIGEgc2VjdXJlLCBIVFRQLW9ubHkgY29va2llXHJcbiAgICByZXMuc2V0SGVhZGVyKCdTZXQtQ29va2llJywgYGF1dGhUb2tlbj0ke3Rva2VufTsgSHR0cE9ubHk7IFBhdGg9LzsgTWF4LUFnZT0zNjAwOyBTYW1lU2l0ZT1TdHJpY3Qke3Byb2Nlc3MuZW52Lk5PREVfRU5WID09PSAncHJvZHVjdGlvbicgPyAnOyBTZWN1cmUnIDogJyd9YCk7XHJcblxyXG4gICAgcmVzLnN0YXR1cygyMDApLmpzb24oeyBcclxuICAgICAgc3VjY2VzczogdHJ1ZSwgXHJcbiAgICAgIG1lc3NhZ2U6ICdTaWduaW4gc3VjY2Vzc2Z1bCcsIFxyXG4gICAgICB0b2tlbiwgLy8gU2VuZCB0b2tlbiB0byBjbGllbnRcclxuICAgICAgZmlyc3ROYW1lOiB1c2VyLmZpcnN0TmFtZSBcclxuICAgIH0pO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKCdTaWduaW4gZXJyb3I6JywgZXJyb3IpO1xyXG4gICAgcmVzLnN0YXR1cyg1MDApLmpzb24oeyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6ICdBbiBlcnJvciBvY2N1cnJlZCBkdXJpbmcgc2lnbmluJyB9KTtcclxuICB9XHJcbn1cclxuICBcclxuICBmdW5jdGlvbiBoYW5kbGVDaGVja0F1dGgocmVxLCByZXMpIHtcclxuICAgIGNvbnN0IHRva2VuID0gcmVxLmhlYWRlcnMuYXV0aG9yaXphdGlvbj8uc3BsaXQoJyAnKVsxXTtcclxuICAgIFxyXG4gICAgaWYgKCF0b2tlbikge1xyXG4gICAgICByZXR1cm4gcmVzLmpzb24oeyBpc0F1dGhlbnRpY2F0ZWQ6IGZhbHNlIH0pO1xyXG4gICAgfVxyXG4gIFxyXG4gICAgdHJ5IHtcclxuICAgICAgY29uc3QgZGVjb2RlZCA9IHZlcmlmeSh0b2tlbiwgcHJvY2Vzcy5lbnYuSldUX1NFQ1JFVCk7XHJcbiAgICAgIGNvbnN0IHVzZXJJZCA9IGRlY29kZWQudXNlcklkO1xyXG4gIFxyXG4gICAgICAvLyBDaGVjayBpZiB0aGUgdXNlciBleGlzdHMgaW4gdGhlIHNlc3Npb25cclxuICAgICAgaWYgKHJlcS5zZXNzaW9uLnVzZXIgJiYgcmVxLnNlc3Npb24udXNlci5pZCA9PT0gdXNlcklkKSB7XHJcbiAgICAgICAgcmVzLmpzb24oeyBcclxuICAgICAgICAgIGlzQXV0aGVudGljYXRlZDogdHJ1ZSwgXHJcbiAgICAgICAgICB1c2VyOiB7IFxyXG4gICAgICAgICAgICBpZDogcmVxLnNlc3Npb24udXNlci5pZCxcclxuICAgICAgICAgICAgZmlyc3ROYW1lOiByZXEuc2Vzc2lvbi51c2VyLmZpcnN0TmFtZSxcclxuICAgICAgICAgICAgZW1haWw6IHJlcS5zZXNzaW9uLnVzZXIuZW1haWxcclxuICAgICAgICAgIH1cclxuICAgICAgICB9KTtcclxuICAgICAgfSBlbHNlIHtcclxuICAgICAgICAvLyBJZiB0aGUgdG9rZW4gaXMgdmFsaWQgYnV0IHRoZSBzZXNzaW9uIGRvZXNuJ3QgZXhpc3QsIGNyZWF0ZSBpdFxyXG4gICAgICAgIC8vIFlvdSBtaWdodCB3YW50IHRvIGZldGNoIHVzZXIgZGF0YSBmcm9tIHRoZSBkYXRhYmFzZSBoZXJlXHJcbiAgICAgICAgcmVxLnNlc3Npb24udXNlciA9IHsgaWQ6IHVzZXJJZCB9O1xyXG4gICAgICAgIHJlcy5qc29uKHsgaXNBdXRoZW50aWNhdGVkOiB0cnVlLCB1c2VyOiB7IGlkOiB1c2VySWQgfSB9KTtcclxuICAgICAgfVxyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgY29uc29sZS5lcnJvcignVG9rZW4gdmVyaWZpY2F0aW9uIGVycm9yOicsIGVycm9yKTtcclxuICAgICAgcmVzLmpzb24oeyBpc0F1dGhlbnRpY2F0ZWQ6IGZhbHNlIH0pO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgZnVuY3Rpb24gaGFuZGxlR2V0VXNlcihyZXEsIHJlcykge1xyXG4gICAgY29uc3QgYXV0aEhlYWRlciA9IHJlcS5oZWFkZXJzLmF1dGhvcml6YXRpb247XHJcbiAgICBjb25zdCB0b2tlbiA9IGF1dGhIZWFkZXIgJiYgYXV0aEhlYWRlci5zcGxpdCgnICcpWzFdO1xyXG4gIFxyXG4gICAgaWYgKCF0b2tlbikge1xyXG4gICAgICBjb25zb2xlLmxvZygnTm8gdG9rZW4gcHJvdmlkZWQgZm9yIC9hcGkvdXNlcicpO1xyXG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDEpLmpzb24oeyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6ICdObyB0b2tlbiBwcm92aWRlZCcgfSk7XHJcbiAgICB9XHJcbiAgXHJcbiAgICB0cnkge1xyXG4gICAgICBjb25zdCBkZWNvZGVkID0gdmVyaWZ5KHRva2VuLCBwcm9jZXNzLmVudi5KV1RfU0VDUkVUKTtcclxuICAgICAgcXVlcnkoJ1NFTEVDVCBpZCwgZmlyc3ROYW1lLCBlbWFpbCBGUk9NIHJlZ2lzdGVyZWRfdXNlcnMgV0hFUkUgaWQgPSA/JywgW2RlY29kZWQudXNlcklkXSlcclxuICAgICAgICAudGhlbih1c2VycyA9PiB7XHJcbiAgICAgICAgICBpZiAodXNlcnMubGVuZ3RoID09PSAwKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKGBVc2VyIG5vdCBmb3VuZCBmb3IgaWQ6ICR7ZGVjb2RlZC51c2VySWR9YCk7XHJcbiAgICAgICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwNCkuanNvbih7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ1VzZXIgbm90IGZvdW5kJyB9KTtcclxuICAgICAgICAgIH1cclxuICBcclxuICAgICAgICAgIGNvbnN0IHVzZXIgPSB1c2Vyc1swXTtcclxuICAgICAgICAgIHJlcy5zdGF0dXMoMjAwKS5qc29uKHsgc3VjY2VzczogdHJ1ZSwgZmlyc3ROYW1lOiB1c2VyLmZpcnN0TmFtZSwgZW1haWw6IHVzZXIuZW1haWwgfSk7XHJcbiAgICAgICAgfSlcclxuICAgICAgICAuY2F0Y2goZXJyb3IgPT4ge1xyXG4gICAgICAgICAgY29uc29sZS5lcnJvcignRGF0YWJhc2UgcXVlcnkgZXJyb3I6JywgZXJyb3IpO1xyXG4gICAgICAgICAgcmVzLnN0YXR1cyg1MDApLmpzb24oeyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6ICdEYXRhYmFzZSBlcnJvcicgfSk7XHJcbiAgICAgICAgfSk7XHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICBjb25zb2xlLmVycm9yKCdHZXQgdXNlciBlcnJvcjonLCBlcnJvcik7XHJcbiAgICAgIGlmIChlcnJvci5uYW1lID09PSAnVG9rZW5FeHBpcmVkRXJyb3InKSB7XHJcbiAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAxKS5qc29uKHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiAnVG9rZW4gZXhwaXJlZCcsIGNvZGU6ICdUT0tFTl9FWFBJUkVEJyB9KTtcclxuICAgICAgfVxyXG4gICAgICByZXMuc3RhdHVzKDQwMSkuanNvbih7IHN1Y2Nlc3M6IGZhbHNlLCBlcnJvcjogJ0ludmFsaWQgdG9rZW4nIH0pO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcbiAgYXN5bmMgZnVuY3Rpb24gaGFuZGxlTG9nb3V0KHJlcSwgcmVzKSB7XHJcbiAgICB0cnkge1xyXG4gICAgICBjb25zdCB1c2VyRW1haWwgPSByZXEuaGVhZGVyc1sndXNlci1lbWFpbCddO1xyXG4gICAgICBjb25zb2xlLmxvZygnUmVjZWl2ZWQgbG9nb3V0IHJlcXVlc3QgZm9yIHVzZXI6JywgdXNlckVtYWlsKTtcclxuICBcclxuICAgICAgaWYgKHVzZXJFbWFpbCkge1xyXG4gICAgICAgIGNvbnN0IGxvZ291dFRpbWUgPSBuZXcgRGF0ZSgpO1xyXG4gICAgICAgIGNvbnNvbGUubG9nKCdVcGRhdGluZyBsb2dvdXQgdGltZTonLCBsb2dvdXRUaW1lKTtcclxuICBcclxuICAgICAgICB0cnkge1xyXG4gICAgICAgICAgY29uc3QgcmVzdWx0ID0gYXdhaXQgcXVlcnkoXHJcbiAgICAgICAgICAgICdVUERBVEUgdXNlcl9sb2dpbiBTRVQgbG9nb3V0X3RpbWUgPSA/IFdIRVJFIGVtYWlsID0gPyBBTkQgbG9nb3V0X3RpbWUgSVMgTlVMTCcsXHJcbiAgICAgICAgICAgIFtsb2dvdXRUaW1lLCB1c2VyRW1haWxdXHJcbiAgICAgICAgICApO1xyXG4gICAgICAgICAgY29uc29sZS5sb2coJ0RhdGFiYXNlIHVwZGF0ZSByZXN1bHQ6JywgcmVzdWx0KTtcclxuICBcclxuICAgICAgICAgIGlmIChyZXN1bHQuYWZmZWN0ZWRSb3dzID09PSAwKSB7XHJcbiAgICAgICAgICAgIGNvbnNvbGUubG9nKCdObyByb3dzIHVwZGF0ZWQuIFVzZXIgbWlnaHQgbm90IGV4aXN0IGluIHVzZXJfbG9naW4gdGFibGUgb3IgYWxyZWFkeSBsb2dnZWQgb3V0LicpO1xyXG4gICAgICAgICAgfSBlbHNlIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coJ0xvZ291dCB0aW1lIHVwZGF0ZWQgc3VjY2Vzc2Z1bGx5IGZvciB1c2VyOicsIHVzZXJFbWFpbCk7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSBjYXRjaCAoZGJFcnJvcikge1xyXG4gICAgICAgICAgY29uc29sZS5lcnJvcignRGF0YWJhc2UgZXJyb3I6JywgZGJFcnJvcik7XHJcbiAgICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg1MDApLmpzb24oeyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6ICdEYXRhYmFzZSBlcnJvciBkdXJpbmcgbG9nb3V0JyB9KTtcclxuICAgICAgICB9XHJcbiAgICAgIH0gZWxzZSB7XHJcbiAgICAgICAgY29uc29sZS5sb2coJ05vIHVzZXIgZW1haWwgcHJvdmlkZWQgaW4gcmVxdWVzdCBoZWFkZXJzJyk7XHJcbiAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAwKS5qc29uKHsgc3VjY2VzczogZmFsc2UsIGVycm9yOiAnVXNlciBlbWFpbCBub3QgcHJvdmlkZWQnIH0pO1xyXG4gICAgICB9XHJcbiAgXHJcbiAgICAgIHJlcy5zZXRIZWFkZXIoJ1NldC1Db29raWUnLCAnYXV0aFRva2VuPTsgSHR0cE9ubHk7IFBhdGg9LzsgTWF4LUFnZT0wOyBTYW1lU2l0ZT1TdHJpY3QnKTtcclxuICAgICAgcmVzLnN0YXR1cygyMDApLmpzb24oeyBzdWNjZXNzOiB0cnVlLCBtZXNzYWdlOiAnTG9nb3V0IHN1Y2Nlc3NmdWwnIH0pO1xyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgY29uc29sZS5lcnJvcignTG9nb3V0IGVycm9yOicsIGVycm9yKTtcclxuICAgICAgcmVzLnN0YXR1cyg1MDApLmpzb24oeyBzdWNjZXNzOiBmYWxzZSwgZXJyb3I6ICdBbiBlcnJvciBvY2N1cnJlZCBkdXJpbmcgbG9nb3V0JyB9KTtcclxuICAgIH1cclxuICB9XHJcblxyXG5cclxuXHJcblxyXG5cclxuICBhc3luYyBmdW5jdGlvbiBoYW5kbGVTZWFyY2gocmVxLCByZXMpIHtcclxuICAgIGNvbnN0IHsgcXVlcnk6IHNlYXJjaFF1ZXJ5IH0gPSBwYXJzZShyZXEudXJsLCB0cnVlKS5xdWVyeTtcclxuICAgIFxyXG4gICAgaWYgKCFzZWFyY2hRdWVyeSkge1xyXG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLmpzb24oeyBlcnJvcjogJ1NlYXJjaCBxdWVyeSBpcyByZXF1aXJlZCcgfSk7XHJcbiAgICB9XHJcbiAgXHJcbiAgICB0cnkge1xyXG4gICAgICBjb25zdCBzZWFyY2hUZXJtcyA9IHNlYXJjaFF1ZXJ5LnNwbGl0KC9cXHMrLykubWFwKHRlcm0gPT4gYCUke3Rlcm19JWApO1xyXG4gICAgICBjb25zdCBwbGFjZWhvbGRlcnMgPSBzZWFyY2hUZXJtcy5tYXAoKCkgPT4gJyhwLm5hbWUgTElLRSA/IE9SIHAuY2F0ZWdvcnkgTElLRSA/KScpLmpvaW4oJyBBTkQgJyk7XHJcbiAgICAgIFxyXG4gICAgICBjb25zdCBzcWwgPSBgXHJcbiAgICAgICAgU0VMRUNUIHAuKiwgXHJcbiAgICAgICAgICAgICAgIENPQUxFU0NFKEFWRyhwci5yYXRpbmcpLCA1KSBhcyBhdmdfcmF0aW5nLFxyXG4gICAgICAgICAgICAgICBDT1VOVChwci5pZCkgYXMgcmF0aW5nX2NvdW50XHJcbiAgICAgICAgRlJPTSBwcm9kdWN0cyBwXHJcbiAgICAgICAgTEVGVCBKT0lOIHByb2R1Y3RfcmF0aW5ncyBwciBPTiBwLmlkID0gcHIucHJvZHVjdF9pZFxyXG4gICAgICAgIFdIRVJFIHAuZGVsZXRlZCA9IDAgQU5EICgke3BsYWNlaG9sZGVyc30pXHJcbiAgICAgICAgR1JPVVAgQlkgcC5pZFxyXG4gICAgICBgO1xyXG4gIFxyXG4gICAgICAvLyBEb3VibGUgdGhlIHNlYXJjaFRlcm1zIGFycmF5IHRvIGFjY291bnQgZm9yIGJvdGggbmFtZSBhbmQgY2F0ZWdvcnlcclxuICAgICAgY29uc3QgcGFyYW1zID0gc2VhcmNoVGVybXMuZmxhdE1hcCh0ZXJtID0+IFt0ZXJtLCB0ZXJtXSk7XHJcbiAgXHJcbiAgICAgIGNvbnN0IHJlc3VsdHMgPSBhd2FpdCBxdWVyeShzcWwsIHBhcmFtcyk7XHJcbiAgICAgIHJlcy5zdGF0dXMoMjAwKS5qc29uKHJlc3VsdHMpO1xyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgY29uc29sZS5lcnJvcihcIkVycm9yIHNlYXJjaGluZyBwcm9kdWN0czpcIiwgZXJyb3IpO1xyXG4gICAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7IGVycm9yOiAnQW4gZXJyb3Igb2NjdXJyZWQgd2hpbGUgc2VhcmNoaW5nIHByb2R1Y3RzJywgZGV0YWlsczogZXJyb3IubWVzc2FnZSB9KTtcclxuICAgIH1cclxuICB9XHJcblxyXG5hc3luYyBmdW5jdGlvbiBoYW5kbGVHZXRQcm9kdWN0cyhyZXEsIHJlcykge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zdCBwcm9kdWN0c1F1ZXJ5ID0gYFxyXG4gICAgICBTRUxFQ1QgcC4qLCBcclxuICAgICAgICAgICAgIENPQUxFU0NFKEFWRyhwci5yYXRpbmcpLCA1KSBhcyBhdmdfcmF0aW5nLFxyXG4gICAgICAgICAgICAgQ09VTlQocHIuaWQpIGFzIHJhdGluZ19jb3VudFxyXG4gICAgICBGUk9NIHByb2R1Y3RzIHBcclxuICAgICAgTEVGVCBKT0lOIHByb2R1Y3RfcmF0aW5ncyBwciBPTiBwLmlkID0gcHIucHJvZHVjdF9pZFxyXG4gICAgICBXSEVSRSBwLmRlbGV0ZWQgPSAwXHJcbiAgICAgIEdST1VQIEJZIHAuaWRcclxuICAgIGA7XHJcbiAgICBjb25zdCBwcm9kdWN0cyA9IGF3YWl0IHF1ZXJ5KHByb2R1Y3RzUXVlcnkpO1xyXG4gICAgcmVzLnN0YXR1cygyMDApLmpzb24ocHJvZHVjdHMpO1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKFwiRXJyb3IgZmV0Y2hpbmcgcHJvZHVjdHM6XCIsIGVycm9yKTtcclxuICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgZXJyb3I6ICdBbiBlcnJvciBvY2N1cnJlZCB3aGlsZSBmZXRjaGluZyBwcm9kdWN0cycsIGRldGFpbHM6IGVycm9yLm1lc3NhZ2UgfSk7XHJcbiAgfVxyXG59XHJcblxyXG5hc3luYyBmdW5jdGlvbiBoYW5kbGVHZXRQcm9kdWN0c0J5Q2F0ZWdvcnkocmVxLCByZXMsIGNhdGVnb3J5KSB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IGRlY29kZWRDYXRlZ29yeSA9IGRlY29kZVVSSUNvbXBvbmVudChjYXRlZ29yeSk7XHJcbiAgICBjb25zb2xlLmxvZyhgQXR0ZW1wdGluZyB0byBmZXRjaCBwcm9kdWN0cyBmb3IgY2F0ZWdvcnk6ICR7ZGVjb2RlZENhdGVnb3J5fWApO1xyXG4gICAgY29uc3QgcHJvZHVjdHNRdWVyeSA9IGBcclxuICAgICAgU0VMRUNUIHAuKiwgXHJcbiAgICAgICAgICAgICBDT0FMRVNDRShBVkcocHIucmF0aW5nKSwgNSkgYXMgYXZnX3JhdGluZyxcclxuICAgICAgICAgICAgIENPVU5UKHByLmlkKSBhcyByYXRpbmdfY291bnRcclxuICAgICAgRlJPTSBwcm9kdWN0cyBwXHJcbiAgICAgIExFRlQgSk9JTiBwcm9kdWN0X3JhdGluZ3MgcHIgT04gcC5pZCA9IHByLnByb2R1Y3RfaWRcclxuICAgICAgV0hFUkUgcC5jYXRlZ29yeSA9ID8gQU5EIHAuZGVsZXRlZCA9IDBcclxuICAgICAgR1JPVVAgQlkgcC5pZFxyXG4gICAgYDtcclxuICAgIGNvbnN0IHByb2R1Y3RzID0gYXdhaXQgcXVlcnkocHJvZHVjdHNRdWVyeSwgW2RlY29kZWRDYXRlZ29yeV0pO1xyXG4gICAgY29uc29sZS5sb2coYEZldGNoZWQgJHtwcm9kdWN0cy5sZW5ndGh9IHByb2R1Y3RzIGZvciBjYXRlZ29yeTogJHtkZWNvZGVkQ2F0ZWdvcnl9YCk7XHJcbiAgICByZXMuc3RhdHVzKDIwMCkuanNvbihwcm9kdWN0cyk7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciBmZXRjaGluZyBwcm9kdWN0cyBieSBjYXRlZ29yeTpcIiwgZXJyb3IpO1xyXG4gICAgcmVzLnN0YXR1cyg1MDApLmpzb24oeyBlcnJvcjogJ0FuIGVycm9yIG9jY3VycmVkIHdoaWxlIGZldGNoaW5nIHByb2R1Y3RzIGJ5IGNhdGVnb3J5JywgZGV0YWlsczogZXJyb3IubWVzc2FnZSwgc3RhY2s6IGVycm9yLnN0YWNrIH0pO1xyXG4gIH1cclxufVxyXG5cclxuYXN5bmMgZnVuY3Rpb24gaGFuZGxlR2V0TGltaXRlZEl0ZW1zKHJlcSwgcmVzKSB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnNvbGUubG9nKFwiQXR0ZW1wdGluZyB0byBmZXRjaCBsaW1pdGVkIGl0ZW1zXCIpO1xyXG4gICAgY29uc3QgbGltaXRlZEl0ZW1zUXVlcnkgPSBgXHJcbiAgICAgIFNFTEVDVCBwLiosIFxyXG4gICAgICAgICAgICAgQ09BTEVTQ0UoQVZHKHByLnJhdGluZyksIDUpIGFzIGF2Z19yYXRpbmcsXHJcbiAgICAgICAgICAgICBDT1VOVChwci5pZCkgYXMgcmF0aW5nX2NvdW50XHJcbiAgICAgIEZST00gcHJvZHVjdHMgcFxyXG4gICAgICBMRUZUIEpPSU4gcHJvZHVjdF9yYXRpbmdzIHByIE9OIHAuaWQgPSBwci5wcm9kdWN0X2lkXHJcbiAgICAgIFdIRVJFIHAuY2F0ZWdvcnkgPSAnTGltaXRlZCBJdGVtcycgQU5EIHAuZGVsZXRlZCA9IDBcclxuICAgICAgR1JPVVAgQlkgcC5pZFxyXG4gICAgYDtcclxuICAgIGNvbnN0IGxpbWl0ZWRJdGVtcyA9IGF3YWl0IHF1ZXJ5KGxpbWl0ZWRJdGVtc1F1ZXJ5KTtcclxuICAgIGNvbnNvbGUubG9nKFwiUXVlcnkgcmVzdWx0OlwiLCBsaW1pdGVkSXRlbXMpO1xyXG4gICAgcmVzLnN0YXR1cygyMDApLmpzb24obGltaXRlZEl0ZW1zKTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcihcIkVycm9yIGZldGNoaW5nIGxpbWl0ZWQgaXRlbXM6XCIsIGVycm9yKTtcclxuICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgZXJyb3I6ICdBbiBlcnJvciBvY2N1cnJlZCB3aGlsZSBmZXRjaGluZyBsaW1pdGVkIGl0ZW1zJywgZGV0YWlsczogZXJyb3IubWVzc2FnZSwgc3RhY2s6IGVycm9yLnN0YWNrIH0pO1xyXG4gIH1cclxufVxyXG4gIFxyXG4gIGFzeW5jIGZ1bmN0aW9uIGhhbmRsZUdldENhdGVnb3JpZXMocmVxLCByZXMpIHtcclxuICAgIHRyeSB7XHJcbiAgICAgIGNvbnN0IGNhdGVnb3JpZXMgPSBhd2FpdCBxdWVyeShgXHJcbiAgICAgICAgU0VMRUNUIERJU1RJTkNUIGNhdGVnb3J5IFxyXG4gICAgICAgIEZST00gcHJvZHVjdHMgXHJcbiAgICAgICAgV0hFUkUgZGVsZXRlZCA9IDAgQU5EIGNhdGVnb3J5ICE9ICdMaW1pdGVkJ1xyXG4gICAgICBgKTtcclxuICAgICAgY29uc3QgZm9ybWF0dGVkQ2F0ZWdvcmllcyA9IGNhdGVnb3JpZXMubWFwKGl0ZW0gPT4gKHsgaWQ6IGl0ZW0uY2F0ZWdvcnksIG5hbWU6IGl0ZW0uY2F0ZWdvcnkgfSkpO1xyXG4gICAgICByZXMuc3RhdHVzKDIwMCkuanNvbihmb3JtYXR0ZWRDYXRlZ29yaWVzKTtcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciBmZXRjaGluZyBjYXRlZ29yaWVzOlwiLCBlcnJvcik7XHJcbiAgICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgZXJyb3I6ICdBbiBlcnJvciBvY2N1cnJlZCB3aGlsZSBmZXRjaGluZyBjYXRlZ29yaWVzJywgZGV0YWlsczogZXJyb3IubWVzc2FnZSB9KTtcclxuICAgIH1cclxuICB9XHJcblxyXG5cclxuXHJcblxyXG5cclxuXHJcbiAgYXN5bmMgZnVuY3Rpb24gaGFuZGxlUGxhY2VPcmRlcihyZXEsIHJlcykge1xyXG4gICAgY29uc3QgYXV0aEhlYWRlciA9IHJlcS5oZWFkZXJzLmF1dGhvcml6YXRpb247XHJcbiAgICBpZiAoIWF1dGhIZWFkZXIpIHtcclxuICAgICAgY29uc29sZS5sb2coJ05vIEF1dGhvcml6YXRpb24gaGVhZGVyIGZvdW5kJyk7XHJcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMSkuanNvbih7IGVycm9yOiAnTm8gdG9rZW4gcHJvdmlkZWQnIH0pO1xyXG4gICAgfVxyXG4gIFxyXG4gICAgY29uc3QgdG9rZW4gPSBhdXRoSGVhZGVyLnNwbGl0KCcgJylbMV07XHJcbiAgICBpZiAoIXRva2VuKSB7XHJcbiAgICAgIGNvbnNvbGUubG9nKCdUb2tlbiBub3QgZm91bmQgaW4gQXV0aG9yaXphdGlvbiBoZWFkZXInKTtcclxuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAxKS5qc29uKHsgZXJyb3I6ICdObyB0b2tlbiBwcm92aWRlZCcgfSk7XHJcbiAgICB9XHJcbiAgXHJcbiAgICB0cnkge1xyXG4gICAgICBjb25zdCBkZWNvZGVkID0gdmVyaWZ5KHRva2VuLCBwcm9jZXNzLmVudi5KV1RfU0VDUkVUKTtcclxuICAgICAgY29uc3QgdXNlcklkID0gZGVjb2RlZC51c2VySWQ7XHJcbiAgXHJcbiAgICAgIGNvbnN0IHsgYmlsbGluZ0luZm8sIHBheW1lbnRNZXRob2QsIGNhcnRJdGVtcywgc3VidG90YWwsIGRlbGl2ZXJ5LCB0b3RhbCB9ID0gcmVxLmJvZHk7XHJcbiAgICAgIGNvbnN0IHRyYWNraW5nTnVtYmVyID0gY3J5cHRvLnJhbmRvbUJ5dGVzKDgpLnRvU3RyaW5nKCdoZXgnKS50b1VwcGVyQ2FzZSgpO1xyXG4gIFxyXG4gICAgICBhd2FpdCBxdWVyeSgnU1RBUlQgVFJBTlNBQ1RJT04nKTtcclxuICBcclxuICAgICAgLy8gSW5zZXJ0IHRoZSBvcmRlclxyXG4gICAgICBjb25zdCBvcmRlclJlc3VsdCA9IGF3YWl0IHF1ZXJ5KFxyXG4gICAgICAgICdJTlNFUlQgSU5UTyBvcmRlcnMgKHVzZXJfaWQsIGZ1bGxfbmFtZSwgcGhvbmVfbnVtYmVyLCBhZGRyZXNzLCBjaXR5LCBzdGF0ZV9wcm92aW5jZSwgcG9zdGFsX2NvZGUsIGRlbGl2ZXJ5X2FkZHJlc3MsIHBheW1lbnRfbWV0aG9kLCBzdWJ0b3RhbCwgZGVsaXZlcnlfZmVlLCB0b3RhbCwgdHJhY2tpbmdfbnVtYmVyLCBzdGF0dXMpIFZBTFVFUyAoPywgPywgPywgPywgPywgPywgPywgPywgPywgPywgPywgPywgPywgPyknLFxyXG4gICAgICAgIFt1c2VySWQsIGJpbGxpbmdJbmZvLmZ1bGxOYW1lLCBiaWxsaW5nSW5mby5waG9uZU51bWJlciwgYmlsbGluZ0luZm8uYWRkcmVzcywgYmlsbGluZ0luZm8uY2l0eSwgYmlsbGluZ0luZm8uc3RhdGVQcm92aW5jZSwgYmlsbGluZ0luZm8ucG9zdGFsQ29kZSwgYmlsbGluZ0luZm8uZGVsaXZlcnlBZGRyZXNzLCBwYXltZW50TWV0aG9kLCBzdWJ0b3RhbCwgZGVsaXZlcnksIHRvdGFsLCB0cmFja2luZ051bWJlciwgJ09yZGVyIFBsYWNlZCddXHJcbiAgICAgICk7XHJcbiAgXHJcbiAgICAgIGNvbnN0IG9yZGVySWQgPSBvcmRlclJlc3VsdC5pbnNlcnRJZDtcclxuICBcclxuICAgICAgLy8gSW5zZXJ0IG9yZGVyZWQgcHJvZHVjdHMgYW5kIHVwZGF0ZSBzdG9jayBxdWFudGl0eVxyXG4gICAgICBmb3IgKGNvbnN0IGl0ZW0gb2YgY2FydEl0ZW1zKSB7XHJcbiAgICAgICAgLy8gQ2hlY2sgaWYgdGhlcmUncyBlbm91Z2ggc3RvY2sgYmVmb3JlIHBsYWNpbmcgdGhlIG9yZGVyXHJcbiAgICAgICAgY29uc3QgW3Byb2R1Y3RdID0gYXdhaXQgcXVlcnkoJ1NFTEVDVCBzdG9ja19xdWFudGl0eSBGUk9NIHByb2R1Y3RzIFdIRVJFIGlkID0gPycsIFtpdGVtLmlkXSk7XHJcbiAgICAgICAgaWYgKCFwcm9kdWN0IHx8IHByb2R1Y3Quc3RvY2tfcXVhbnRpdHkgPCBpdGVtLnF1YW50aXR5KSB7XHJcbiAgICAgICAgICBhd2FpdCBxdWVyeSgnUk9MTEJBQ0snKTtcclxuICAgICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7IGVycm9yOiBgTm90IGVub3VnaCBzdG9jayBmb3IgcHJvZHVjdDogJHtpdGVtLm5hbWV9YCB9KTtcclxuICAgICAgICB9XHJcbiAgXHJcbiAgICAgICAgYXdhaXQgcXVlcnkoXHJcbiAgICAgICAgICAnSU5TRVJUIElOVE8gb3JkZXJlZF9wcm9kdWN0cyAobmFtZSwgcHJvZHVjdF9pZCwgb3JkZXJfaWQsIHF1YW50aXR5LCBwcmljZSkgVkFMVUVTICg/LCA/LCA/LCA/LCA/KScsXHJcbiAgICAgICAgICBbaXRlbS5uYW1lLCBpdGVtLmlkLCBvcmRlcklkLCBpdGVtLnF1YW50aXR5LCBpdGVtLnByaWNlXVxyXG4gICAgICAgICk7XHJcbiAgXHJcbiAgICAgICAgLy8gVXBkYXRlIHN0b2NrIHF1YW50aXR5XHJcbiAgICAgICAgY29uc3QgdXBkYXRlUmVzdWx0ID0gYXdhaXQgcXVlcnkoXHJcbiAgICAgICAgICAnVVBEQVRFIHByb2R1Y3RzIFNFVCBzdG9ja19xdWFudGl0eSA9IHN0b2NrX3F1YW50aXR5IC0gPyBXSEVSRSBpZCA9ID8nLFxyXG4gICAgICAgICAgW2l0ZW0ucXVhbnRpdHksIGl0ZW0uaWRdXHJcbiAgICAgICAgKTtcclxuICBcclxuICAgICAgICBpZiAodXBkYXRlUmVzdWx0LmFmZmVjdGVkUm93cyA9PT0gMCkge1xyXG4gICAgICAgICAgLy8gSWYgbm8gcm93cyB3ZXJlIHVwZGF0ZWQsIGl0IG1lYW5zIHRoZXJlJ3Mgbm90IGVub3VnaCBzdG9ja1xyXG4gICAgICAgICAgYXdhaXQgcXVlcnkoJ1JPTExCQUNLJyk7XHJcbiAgICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDApLmpzb24oeyBlcnJvcjogYE5vdCBlbm91Z2ggc3RvY2sgZm9yIHByb2R1Y3Q6ICR7aXRlbS5uYW1lfWAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgICB9XHJcbiAgXHJcbiAgICAgIGF3YWl0IHF1ZXJ5KCdDT01NSVQnKTtcclxuICAgICAgcmVzLmpzb24oeyBzdWNjZXNzOiB0cnVlLCBvcmRlcklkLCB0cmFja2luZ051bWJlciB9KTtcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIGF3YWl0IHF1ZXJ5KCdST0xMQkFDSycpO1xyXG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBwbGFjaW5nIG9yZGVyOicsIGVycm9yKTtcclxuICAgICAgaWYgKGVycm9yLm5hbWUgPT09ICdKc29uV2ViVG9rZW5FcnJvcicpIHtcclxuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDEpLmpzb24oeyBlcnJvcjogJ0ludmFsaWQgdG9rZW4nIH0pO1xyXG4gICAgICB9XHJcbiAgICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgZXJyb3I6ICdBbiBlcnJvciBvY2N1cnJlZCB3aGlsZSBwbGFjaW5nIHRoZSBvcmRlcicgfSk7XHJcbiAgICB9XHJcbiAgfVxyXG4gIFxyXG4gIFxyXG4gIGFzeW5jIGZ1bmN0aW9uIGhhbmRsZUdldE9yZGVyKHJlcSwgcmVzKSB7XHJcbiAgICBjb25zdCBhdXRoSGVhZGVyID0gcmVxLmhlYWRlcnMuYXV0aG9yaXphdGlvbjtcclxuICAgIGlmICghYXV0aEhlYWRlcikge1xyXG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDEpLmpzb24oeyBlcnJvcjogJ05vIHRva2VuIHByb3ZpZGVkJyB9KTtcclxuICAgIH1cclxuICBcclxuICAgIGNvbnN0IHRva2VuID0gYXV0aEhlYWRlci5zcGxpdCgnICcpWzFdO1xyXG4gICAgaWYgKCF0b2tlbikge1xyXG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDEpLmpzb24oeyBlcnJvcjogJ05vIHRva2VuIHByb3ZpZGVkJyB9KTtcclxuICAgIH1cclxuICBcclxuICAgIHRyeSB7XHJcbiAgICAgIGNvbnN0IGRlY29kZWQgPSB2ZXJpZnkodG9rZW4sIHByb2Nlc3MuZW52LkpXVF9TRUNSRVQpO1xyXG4gICAgICBjb25zdCB1c2VySWQgPSBkZWNvZGVkLnVzZXJJZDtcclxuICBcclxuICAgICAgY29uc3Qgb3JkZXJJZCA9IHJlcS5xdWVyeS5vcmRlcklkIHx8IHJlcS51cmwuc3BsaXQoJy8nKS5wb3AoKTtcclxuICBcclxuICAgICAgY29uc3QgcmVzdWx0cyA9IGF3YWl0IHF1ZXJ5KGBcclxuICAgICAgICBTRUxFQ1Qgby4qLCBvcC5uYW1lLCBvcC5wcm9kdWN0X2lkLCBvcC5xdWFudGl0eSwgb3AucHJpY2UsIHAuaW1hZ2VfdXJsXHJcbiAgICAgICAgRlJPTSBvcmRlcnMgb1xyXG4gICAgICAgIEpPSU4gb3JkZXJlZF9wcm9kdWN0cyBvcCBPTiBvLmlkID0gb3Aub3JkZXJfaWRcclxuICAgICAgICBKT0lOIHByb2R1Y3RzIHAgT04gb3AucHJvZHVjdF9pZCA9IHAuaWRcclxuICAgICAgICBXSEVSRSBvLmlkID0gPyBBTkQgby51c2VyX2lkID0gP1xyXG4gICAgICBgLCBbb3JkZXJJZCwgdXNlcklkXSk7XHJcbiAgXHJcbiAgICAgIGlmIChyZXN1bHRzLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwNCkuanNvbih7IGVycm9yOiAnT3JkZXIgbm90IGZvdW5kJyB9KTtcclxuICAgICAgfVxyXG4gIFxyXG4gICAgICBjb25zdCBvcmRlckRldGFpbHMgPSB7XHJcbiAgICAgICAgb3JkZXJJZDogcmVzdWx0c1swXS5pZCxcclxuICAgICAgICB0cmFja2luZ051bWJlcjogcmVzdWx0c1swXS50cmFja2luZ19udW1iZXIsXHJcbiAgICAgICAgc3RhdHVzOiByZXN1bHRzWzBdLnN0YXR1cyxcclxuICAgICAgICBiaWxsaW5nSW5mbzoge1xyXG4gICAgICAgICAgZnVsbE5hbWU6IHJlc3VsdHNbMF0uZnVsbF9uYW1lLFxyXG4gICAgICAgICAgcGhvbmVOdW1iZXI6IHJlc3VsdHNbMF0ucGhvbmVfbnVtYmVyLFxyXG4gICAgICAgICAgYWRkcmVzczogcmVzdWx0c1swXS5hZGRyZXNzLFxyXG4gICAgICAgICAgY2l0eTogcmVzdWx0c1swXS5jaXR5LFxyXG4gICAgICAgICAgc3RhdGVQcm92aW5jZTogcmVzdWx0c1swXS5zdGF0ZV9wcm92aW5jZSxcclxuICAgICAgICAgIHBvc3RhbENvZGU6IHJlc3VsdHNbMF0ucG9zdGFsX2NvZGUsXHJcbiAgICAgICAgICBkZWxpdmVyeUFkZHJlc3M6IHJlc3VsdHNbMF0uZGVsaXZlcnlfYWRkcmVzcyxcclxuICAgICAgICB9LFxyXG4gICAgICAgIHBheW1lbnRNZXRob2Q6IHJlc3VsdHNbMF0ucGF5bWVudF9tZXRob2QsXHJcbiAgICAgICAgaXRlbXM6IHJlc3VsdHMubWFwKGl0ZW0gPT4gKHtcclxuICAgICAgICAgIGlkOiBpdGVtLnByb2R1Y3RfaWQsXHJcbiAgICAgICAgICBuYW1lOiBpdGVtLm5hbWUsXHJcbiAgICAgICAgICBxdWFudGl0eTogaXRlbS5xdWFudGl0eSxcclxuICAgICAgICAgIHByaWNlOiBpdGVtLnByaWNlLFxyXG4gICAgICAgICAgaW1hZ2VVcmw6IGl0ZW0uaW1hZ2VfdXJsLFxyXG4gICAgICAgIH0pKSxcclxuICAgICAgICBzdWJ0b3RhbDogcmVzdWx0c1swXS5zdWJ0b3RhbCxcclxuICAgICAgICBkZWxpdmVyeTogcmVzdWx0c1swXS5kZWxpdmVyeV9mZWUsXHJcbiAgICAgICAgdG90YWw6IHJlc3VsdHNbMF0udG90YWwsXHJcbiAgICAgIH07XHJcbiAgXHJcbiAgICAgIHJlcy5qc29uKG9yZGVyRGV0YWlscyk7XHJcbiAgICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBmZXRjaGluZyBvcmRlciBkZXRhaWxzOicsIGVycm9yKTtcclxuICAgICAgaWYgKGVycm9yLm5hbWUgPT09ICdKc29uV2ViVG9rZW5FcnJvcicpIHtcclxuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDEpLmpzb24oeyBlcnJvcjogJ0ludmFsaWQgdG9rZW4nIH0pO1xyXG4gICAgICB9XHJcbiAgICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgZXJyb3I6ICdBbiBlcnJvciBvY2N1cnJlZCB3aGlsZSBmZXRjaGluZyBvcmRlciBkZXRhaWxzJyB9KTtcclxuICAgIH1cclxuICB9XHJcblxyXG5cclxuXHJcblxyXG5cclxuICBhc3luYyBmdW5jdGlvbiBoYW5kbGVBbGxPcmRlcnMocmVxLCByZXMpIHtcclxuICAgIGNvbnN0IGF1dGhIZWFkZXIgPSByZXEuaGVhZGVycy5hdXRob3JpemF0aW9uO1xyXG4gICAgaWYgKCFhdXRoSGVhZGVyKSB7XHJcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMSkuanNvbih7IGVycm9yOiAnTm8gdG9rZW4gcHJvdmlkZWQnIH0pO1xyXG4gICAgfVxyXG4gIFxyXG4gICAgY29uc3QgdG9rZW4gPSBhdXRoSGVhZGVyLnNwbGl0KCcgJylbMV07XHJcbiAgICBpZiAoIXRva2VuKSB7XHJcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMSkuanNvbih7IGVycm9yOiAnTm8gdG9rZW4gcHJvdmlkZWQnIH0pO1xyXG4gICAgfVxyXG4gIFxyXG4gICAgdHJ5IHtcclxuICAgICAgY29uc3QgZGVjb2RlZCA9IHZlcmlmeSh0b2tlbiwgcHJvY2Vzcy5lbnYuSldUX1NFQ1JFVCk7XHJcbiAgICAgIGNvbnN0IHVzZXJJZCA9IGRlY29kZWQudXNlcklkO1xyXG4gIFxyXG4gICAgICBjb25zdCBvcmRlcnMgPSBhd2FpdCBxdWVyeShgXHJcbiAgICAgICAgU0VMRUNUIGlkLCB0cmFja2luZ19udW1iZXIsIHN0YXR1cywgb3JkZXJfZGF0ZSwgdG90YWxcclxuICAgICAgICBGUk9NIG9yZGVyc1xyXG4gICAgICAgIFdIRVJFIHVzZXJfaWQgPSA/XHJcbiAgICAgICAgT1JERVIgQlkgb3JkZXJfZGF0ZSBERVNDXHJcbiAgICAgIGAsIFt1c2VySWRdKTtcclxuICBcclxuICAgICAgcmVzLnN0YXR1cygyMDApLmpzb24ob3JkZXJzKTtcclxuICAgIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICAgIGlmIChlcnJvci5uYW1lID09PSAnSnNvbldlYlRva2VuRXJyb3InKSB7XHJcbiAgICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAxKS5qc29uKHsgZXJyb3I6ICdJbnZhbGlkIHRva2VuJyB9KTtcclxuICAgICAgfVxyXG4gICAgICBjb25zb2xlLmVycm9yKCdFcnJvciBmZXRjaGluZyBhbGwgb3JkZXJzOicsIGVycm9yKTtcclxuICAgICAgcmVzLnN0YXR1cyg1MDApLmpzb24oeyBlcnJvcjogJ0FuIGVycm9yIG9jY3VycmVkIHdoaWxlIGZldGNoaW5nIG9yZGVycycsIGRldGFpbHM6IGVycm9yLm1lc3NhZ2UgfSk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBhc3luYyBmdW5jdGlvbiBoYW5kbGVDYW5jZWxPcmRlcihyZXEsIHJlcykge1xyXG4gICAgY29uc3QgYXV0aEhlYWRlciA9IHJlcS5oZWFkZXJzLmF1dGhvcml6YXRpb247XHJcbiAgICBpZiAoIWF1dGhIZWFkZXIpIHtcclxuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAxKS5qc29uKHsgZXJyb3I6ICdObyB0b2tlbiBwcm92aWRlZCcgfSk7XHJcbiAgICB9XHJcbiAgXHJcbiAgICBjb25zdCB0b2tlbiA9IGF1dGhIZWFkZXIuc3BsaXQoJyAnKVsxXTtcclxuICAgIGlmICghdG9rZW4pIHtcclxuICAgICAgcmV0dXJuIHJlcy5zdGF0dXMoNDAxKS5qc29uKHsgZXJyb3I6ICdObyB0b2tlbiBwcm92aWRlZCcgfSk7XHJcbiAgICB9XHJcbiAgXHJcbiAgICB0cnkge1xyXG4gICAgICBjb25zdCBkZWNvZGVkID0gdmVyaWZ5KHRva2VuLCBwcm9jZXNzLmVudi5KV1RfU0VDUkVUKTtcclxuICAgICAgY29uc3QgdXNlcklkID0gZGVjb2RlZC51c2VySWQ7XHJcbiAgXHJcbiAgICAgIGNvbnN0IG9yZGVySWQgPSByZXEudXJsLnNwbGl0KCcvJykucG9wKCk7XHJcbiAgXHJcbiAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHF1ZXJ5KGBcclxuICAgICAgICBVUERBVEUgb3JkZXJzXHJcbiAgICAgICAgU0VUIHN0YXR1cyA9ICdDYW5jZWxsZWQnXHJcbiAgICAgICAgV0hFUkUgaWQgPSA/IEFORCB1c2VyX2lkID0gPyBBTkQgc3RhdHVzID0gJ09yZGVyIFBsYWNlZCdcclxuICAgICAgYCwgW29yZGVySWQsIHVzZXJJZF0pO1xyXG4gIFxyXG4gICAgICBpZiAocmVzdWx0LmFmZmVjdGVkUm93cyA9PT0gMCkge1xyXG4gICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7IGVycm9yOiAnT3JkZXIgbm90IGZvdW5kIG9yIGNhbm5vdCBiZSBjYW5jZWxsZWQnIH0pO1xyXG4gICAgICB9XHJcbiAgXHJcbiAgICAgIHJlcy5qc29uKHsgc3VjY2VzczogdHJ1ZSwgbWVzc2FnZTogJ09yZGVyIGNhbmNlbGxlZCBzdWNjZXNzZnVsbHknIH0pO1xyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgaWYgKGVycm9yLm5hbWUgPT09ICdKc29uV2ViVG9rZW5FcnJvcicpIHtcclxuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDEpLmpzb24oeyBlcnJvcjogJ0ludmFsaWQgdG9rZW4nIH0pO1xyXG4gICAgICB9XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGNhbmNlbGxpbmcgb3JkZXI6JywgZXJyb3IpO1xyXG4gICAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7IGVycm9yOiAnQW4gZXJyb3Igb2NjdXJyZWQgd2hpbGUgY2FuY2VsbGluZyB0aGUgb3JkZXInIH0pO1xyXG4gICAgfVxyXG4gIH1cclxuXHJcblxyXG5cclxuXHJcblxyXG5cclxuICBhc3luYyBmdW5jdGlvbiBoYW5kbGVPcmRlckhpc3RvcnkocmVxLCByZXMpIHtcclxuICAgIGNvbnN0IGF1dGhIZWFkZXIgPSByZXEuaGVhZGVycy5hdXRob3JpemF0aW9uO1xyXG4gICAgaWYgKCFhdXRoSGVhZGVyKSB7XHJcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMSkuanNvbih7IGVycm9yOiAnTm8gdG9rZW4gcHJvdmlkZWQnIH0pO1xyXG4gICAgfVxyXG4gIFxyXG4gICAgY29uc3QgdG9rZW4gPSBhdXRoSGVhZGVyLnNwbGl0KCcgJylbMV07XHJcbiAgICBpZiAoIXRva2VuKSB7XHJcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMSkuanNvbih7IGVycm9yOiAnTm8gdG9rZW4gcHJvdmlkZWQnIH0pO1xyXG4gICAgfVxyXG4gIFxyXG4gICAgdHJ5IHtcclxuICAgICAgY29uc3QgZGVjb2RlZCA9IHZlcmlmeSh0b2tlbiwgcHJvY2Vzcy5lbnYuSldUX1NFQ1JFVCk7XHJcbiAgICAgIGNvbnN0IHVzZXJJZCA9IGRlY29kZWQudXNlcklkO1xyXG4gIFxyXG4gICAgICBjb25zdCBvcmRlcnMgPSBhd2FpdCBxdWVyeShgXHJcbiAgICAgICAgU0VMRUNUIG8uaWQsIG8udHJhY2tpbmdfbnVtYmVyLCBvLnN0YXR1cywgby5vcmRlcl9kYXRlLCBvLnRvdGFsLCBvLmlzX3JhdGVkLFxyXG4gICAgICAgICAgICAgICBHUk9VUF9DT05DQVQob3AubmFtZSBTRVBBUkFUT1IgJywgJykgQVMgcHJvZHVjdHNcclxuICAgICAgICBGUk9NIG9yZGVycyBvXHJcbiAgICAgICAgSk9JTiBvcmRlcmVkX3Byb2R1Y3RzIG9wIE9OIG8uaWQgPSBvcC5vcmRlcl9pZFxyXG4gICAgICAgIFdIRVJFIG8udXNlcl9pZCA9ID9cclxuICAgICAgICBHUk9VUCBCWSBvLmlkXHJcbiAgICAgICAgT1JERVIgQlkgby5vcmRlcl9kYXRlIERFU0NcclxuICAgICAgYCwgW3VzZXJJZF0pO1xyXG4gIFxyXG4gICAgICByZXMuc3RhdHVzKDIwMCkuanNvbihvcmRlcnMpO1xyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgaWYgKGVycm9yLm5hbWUgPT09ICdKc29uV2ViVG9rZW5FcnJvcicpIHtcclxuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDEpLmpzb24oeyBlcnJvcjogJ0ludmFsaWQgdG9rZW4nIH0pO1xyXG4gICAgICB9XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIGZldGNoaW5nIG9yZGVyIGhpc3Rvcnk6JywgZXJyb3IpO1xyXG4gICAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7IGVycm9yOiAnQW4gZXJyb3Igb2NjdXJyZWQgd2hpbGUgZmV0Y2hpbmcgb3JkZXIgaGlzdG9yeScsIGRldGFpbHM6IGVycm9yLm1lc3NhZ2UgfSk7XHJcbiAgICB9XHJcbiAgfVxyXG5cclxuICBhc3luYyBmdW5jdGlvbiBoYW5kbGVTdWJtaXRSYXRpbmdzKHJlcSwgcmVzKSB7XHJcbiAgICBjb25zdCBhdXRoSGVhZGVyID0gcmVxLmhlYWRlcnMuYXV0aG9yaXphdGlvbjtcclxuICAgIGlmICghYXV0aEhlYWRlcikge1xyXG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDEpLmpzb24oeyBlcnJvcjogJ05vIHRva2VuIHByb3ZpZGVkJyB9KTtcclxuICAgIH1cclxuICBcclxuICAgIGNvbnN0IHRva2VuID0gYXV0aEhlYWRlci5zcGxpdCgnICcpWzFdO1xyXG4gICAgaWYgKCF0b2tlbikge1xyXG4gICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDEpLmpzb24oeyBlcnJvcjogJ05vIHRva2VuIHByb3ZpZGVkJyB9KTtcclxuICAgIH1cclxuICBcclxuICAgIHRyeSB7XHJcbiAgICAgIGNvbnN0IGRlY29kZWQgPSB2ZXJpZnkodG9rZW4sIHByb2Nlc3MuZW52LkpXVF9TRUNSRVQpO1xyXG4gICAgICBjb25zdCB1c2VySWQgPSBkZWNvZGVkLnVzZXJJZDtcclxuICBcclxuICAgICAgY29uc3Qgb3JkZXJJZCA9IHJlcS51cmwuc3BsaXQoJy8nKS5wb3AoKTtcclxuICAgICAgY29uc3QgeyByYXRpbmdzLCBmZWVkYmFjayB9ID0gcmVxLmJvZHk7XHJcbiAgXHJcbiAgICAgIC8vIFZlcmlmeSB0aGF0IHRoZSBvcmRlciBiZWxvbmdzIHRvIHRoZSB1c2VyXHJcbiAgICAgIGNvbnN0IG9yZGVyQ2hlY2sgPSBhd2FpdCBxdWVyeSgnU0VMRUNUIGlkIEZST00gb3JkZXJzIFdIRVJFIGlkID0gPyBBTkQgdXNlcl9pZCA9ID8nLCBbb3JkZXJJZCwgdXNlcklkXSk7XHJcbiAgICAgIGlmIChvcmRlckNoZWNrLmxlbmd0aCA9PT0gMCkge1xyXG4gICAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMykuanNvbih7IGVycm9yOiAnVW5hdXRob3JpemVkIHRvIHJhdGUgdGhpcyBvcmRlcicgfSk7XHJcbiAgICAgIH1cclxuICAgICAgLy8gU3RhcnQgYSB0cmFuc2FjdGlvblxyXG4gICAgICBhd2FpdCBxdWVyeSgnU1RBUlQgVFJBTlNBQ1RJT04nKTtcclxuICAgICAgdHJ5IHtcclxuICAgICAgICAvLyBJbnNlcnQgcmF0aW5ncyBmb3IgZWFjaCBwcm9kdWN0XHJcbiAgICAgICAgZm9yIChjb25zdCBbcHJvZHVjdElkLCByYXRpbmddIG9mIE9iamVjdC5lbnRyaWVzKHJhdGluZ3MpKSB7XHJcbiAgICAgICAgICBhd2FpdCBxdWVyeSgnSU5TRVJUIElOVE8gcHJvZHVjdF9yYXRpbmdzIChvcmRlcl9pZCwgcHJvZHVjdF9pZCwgcmF0aW5nKSBWQUxVRVMgKD8sID8sID8pJywgW29yZGVySWQsIHByb2R1Y3RJZCwgcmF0aW5nXSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIC8vIEluc2VydCBmZWVkYmFja1xyXG4gICAgICAgIGlmIChmZWVkYmFjaykge1xyXG4gICAgICAgICAgYXdhaXQgcXVlcnkoJ0lOU0VSVCBJTlRPIG9yZGVyX2ZlZWRiYWNrIChvcmRlcl9pZCwgZmVlZGJhY2spIFZBTFVFUyAoPywgPyknLCBbb3JkZXJJZCwgZmVlZGJhY2tdKTtcclxuICAgICAgICB9XHJcbiAgXHJcbiAgICAgICAgLy8gVXBkYXRlIHRoZSBvcmRlciB0byBtYXJrIGl0IGFzIHJhdGVkXHJcbiAgICAgICAgYXdhaXQgcXVlcnkoJ1VQREFURSBvcmRlcnMgU0VUIGlzX3JhdGVkID0gMSBXSEVSRSBpZCA9ID8nLCBbb3JkZXJJZF0pO1xyXG4gIFxyXG4gICAgICAgIC8vIENvbW1pdCB0aGUgdHJhbnNhY3Rpb25cclxuICAgICAgICBhd2FpdCBxdWVyeSgnQ09NTUlUJyk7XHJcbiAgXHJcbiAgICAgICAgcmVzLnN0YXR1cygyMDApLmpzb24oeyBzdWNjZXNzOiB0cnVlLCBtZXNzYWdlOiAnUmF0aW5ncyBzdWJtaXR0ZWQgc3VjY2Vzc2Z1bGx5JyB9KTtcclxuICAgICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgICAvLyBJZiB0aGVyZSdzIGFuIGVycm9yLCByb2xsYmFjayB0aGUgdHJhbnNhY3Rpb25cclxuICAgICAgICBhd2FpdCBxdWVyeSgnUk9MTEJBQ0snKTtcclxuICAgICAgICB0aHJvdyBlcnJvcjtcclxuICAgICAgfVxyXG4gICAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgICAgaWYgKGVycm9yLm5hbWUgPT09ICdKc29uV2ViVG9rZW5FcnJvcicpIHtcclxuICAgICAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDEpLmpzb24oeyBlcnJvcjogJ0ludmFsaWQgdG9rZW4nIH0pO1xyXG4gICAgICB9XHJcbiAgICAgIGNvbnNvbGUuZXJyb3IoJ0Vycm9yIHN1Ym1pdHRpbmcgcmF0aW5nczonLCBlcnJvcik7XHJcbiAgICAgIHJlcy5zdGF0dXMoNTAwKS5qc29uKHsgZXJyb3I6ICdBbiBlcnJvciBvY2N1cnJlZCB3aGlsZSBzdWJtaXR0aW5nIHJhdGluZ3MnLCBkZXRhaWxzOiBlcnJvci5tZXNzYWdlIH0pO1xyXG4gICAgfVxyXG4gIH1cclxuICBcclxuICBcclxuICBcclxuICBcclxuICBcclxuIFxyXG4gIFxyXG5cclxuICBleHBvcnQgZGVmYXVsdCB3aXRoSXJvblNlc3Npb24oaGFuZGxlciwge1xyXG4gICAgcGFzc3dvcmQ6IHByb2Nlc3MuZW52LlNFU1NJT05fUEFTU1dPUkQsXHJcbiAgICBjb29raWVOYW1lOiAnbmFyc19zZXNzaW9uJyxcclxuICAgIGNvb2tpZU9wdGlvbnM6IHtcclxuICAgICAgc2VjdXJlOiBwcm9jZXNzLmVudi5OT0RFX0VOViA9PT0gJ3Byb2R1Y3Rpb24nLFxyXG4gICAgICBzYW1lU2l0ZTogJ3N0cmljdCcsXHJcbiAgICAgIGh0dHBPbmx5OiB0cnVlLFxyXG4gICAgfSxcclxuICB9KTsiXSwibmFtZXMiOlsicGFyc2UiLCJiY3J5cHQiLCJzaWduIiwidmVyaWZ5IiwicXVlcnkiLCJjcnlwdG8iLCJ3aXRoSXJvblNlc3Npb24iLCJoYW5kbGVyIiwicmVxIiwicmVzIiwibWV0aG9kIiwicGF0aG5hbWUiLCJ1cmwiLCJoYW5kbGVDaGVja0F1dGgiLCJzdGFydHNXaXRoIiwiaGFuZGxlR2V0T3JkZXIiLCJoYW5kbGVPcmRlclRyYWNraW5nIiwiaGFuZGxlT3JkZXJIaXN0b3J5IiwiaGFuZGxlQWxsT3JkZXJzIiwiaGFuZGxlTG9nb3V0IiwiaGFuZGxlR2V0VXNlciIsImhhbmRsZUdldFByb2R1Y3RzIiwiY2F0ZWdvcnkiLCJzcGxpdCIsInBvcCIsImhhbmRsZUdldFByb2R1Y3RzQnlDYXRlZ29yeSIsImhhbmRsZUdldENhcnQiLCJoYW5kbGVHZXRMaW1pdGVkSXRlbXMiLCJoYW5kbGVHZXRDYXRlZ29yaWVzIiwiaGFuZGxlU2VhcmNoIiwic3RhdHVzIiwianNvbiIsImVycm9yIiwiaGFuZGxlU2lnbnVwIiwiaGFuZGxlU2lnbmluIiwiaGFuZGxlUGxhY2VPcmRlciIsImhhbmRsZUNhbmNlbE9yZGVyIiwiaGFuZGxlU3VibWl0UmF0aW5ncyIsImhhbmRsZUFkZFRvQ2FydCIsImhhbmRsZVVwZGF0ZUNhcnQiLCJoYW5kbGVSZW1vdmVGcm9tQ2FydCIsInNldEhlYWRlciIsImVuZCIsImNvbnNvbGUiLCJmaXJzdG5hbWUiLCJsYXN0bmFtZSIsImFkZHJlc3MiLCJtb2JpbGUiLCJlbWFpbCIsInBhc3N3b3JkIiwiYm9keSIsImV4aXN0aW5nVXNlciIsImxlbmd0aCIsImhhc2hlZFBhc3N3b3JkIiwiaGFzaCIsInJlc3VsdCIsInRva2VuIiwidXNlcklkIiwiaW5zZXJ0SWQiLCJwcm9jZXNzIiwiZW52IiwiSldUX1NFQ1JFVCIsImV4cGlyZXNJbiIsIm1lc3NhZ2UiLCJ1c2VycyIsInN1Y2Nlc3MiLCJ1c2VyIiwibWF0Y2giLCJjb21wYXJlIiwiaWQiLCJzZXNzaW9uIiwiZmlyc3ROYW1lIiwic2F2ZSIsImxvZ2luVGltZSIsIkRhdGUiLCJoZWFkZXJzIiwiYXV0aG9yaXphdGlvbiIsImlzQXV0aGVudGljYXRlZCIsImRlY29kZWQiLCJhdXRoSGVhZGVyIiwibG9nIiwidGhlbiIsImNhdGNoIiwibmFtZSIsImNvZGUiLCJ1c2VyRW1haWwiLCJsb2dvdXRUaW1lIiwiYWZmZWN0ZWRSb3dzIiwiZGJFcnJvciIsInNlYXJjaFF1ZXJ5Iiwic2VhcmNoVGVybXMiLCJtYXAiLCJ0ZXJtIiwicGxhY2Vob2xkZXJzIiwiam9pbiIsInNxbCIsInBhcmFtcyIsImZsYXRNYXAiLCJyZXN1bHRzIiwiZGV0YWlscyIsInByb2R1Y3RzUXVlcnkiLCJwcm9kdWN0cyIsImRlY29kZWRDYXRlZ29yeSIsImRlY29kZVVSSUNvbXBvbmVudCIsInN0YWNrIiwibGltaXRlZEl0ZW1zUXVlcnkiLCJsaW1pdGVkSXRlbXMiLCJjYXRlZ29yaWVzIiwiZm9ybWF0dGVkQ2F0ZWdvcmllcyIsIml0ZW0iLCJiaWxsaW5nSW5mbyIsInBheW1lbnRNZXRob2QiLCJjYXJ0SXRlbXMiLCJzdWJ0b3RhbCIsImRlbGl2ZXJ5IiwidG90YWwiLCJ0cmFja2luZ051bWJlciIsInJhbmRvbUJ5dGVzIiwidG9TdHJpbmciLCJ0b1VwcGVyQ2FzZSIsIm9yZGVyUmVzdWx0IiwiZnVsbE5hbWUiLCJwaG9uZU51bWJlciIsImNpdHkiLCJzdGF0ZVByb3ZpbmNlIiwicG9zdGFsQ29kZSIsImRlbGl2ZXJ5QWRkcmVzcyIsIm9yZGVySWQiLCJwcm9kdWN0Iiwic3RvY2tfcXVhbnRpdHkiLCJxdWFudGl0eSIsInByaWNlIiwidXBkYXRlUmVzdWx0Iiwib3JkZXJEZXRhaWxzIiwidHJhY2tpbmdfbnVtYmVyIiwiZnVsbF9uYW1lIiwicGhvbmVfbnVtYmVyIiwic3RhdGVfcHJvdmluY2UiLCJwb3N0YWxfY29kZSIsImRlbGl2ZXJ5X2FkZHJlc3MiLCJwYXltZW50X21ldGhvZCIsIml0ZW1zIiwicHJvZHVjdF9pZCIsImltYWdlVXJsIiwiaW1hZ2VfdXJsIiwiZGVsaXZlcnlfZmVlIiwib3JkZXJzIiwicmF0aW5ncyIsImZlZWRiYWNrIiwib3JkZXJDaGVjayIsInByb2R1Y3RJZCIsInJhdGluZyIsIk9iamVjdCIsImVudHJpZXMiLCJTRVNTSU9OX1BBU1NXT1JEIiwiY29va2llTmFtZSIsImNvb2tpZU9wdGlvbnMiLCJzZWN1cmUiLCJzYW1lU2l0ZSIsImh0dHBPbmx5Il0sInNvdXJjZVJvb3QiOiIifQ==\n//# sourceURL=webpack-internal:///(api)/./src/pages/api/[...narsapi].js\n");

/***/ }),

/***/ "(api)/./src/utils/db.js":
/*!*************************!*\
  !*** ./src/utils/db.js ***!
  \*************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   query: () => (/* binding */ query)\n/* harmony export */ });\n/* harmony import */ var mysql2_promise__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! mysql2/promise */ \"mysql2/promise\");\n/* harmony import */ var mysql2_promise__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(mysql2_promise__WEBPACK_IMPORTED_MODULE_0__);\n\nconst pool = mysql2_promise__WEBPACK_IMPORTED_MODULE_0___default().createPool({\n    host: process.env.MYSQL_HOST,\n    port: parseInt(process.env.MYSQL_PORT),\n    database: process.env.MYSQL_DATABASE,\n    user: process.env.MYSQL_USER,\n    password: process.env.MYSQL_PASSWORD,\n    connectionLimit: 10,\n    waitForConnections: true,\n    queueLimit: 0\n});\nasync function query(sql, values) {\n    try {\n        const [results] = await pool.query(sql, values);\n        return results;\n    } catch (error) {\n        console.error(\"Database query error:\", error);\n        throw error;\n    }\n}\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = (pool);\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9zcmMvdXRpbHMvZGIuanMiLCJtYXBwaW5ncyI6Ijs7Ozs7OztBQUFtQztBQUVuQyxNQUFNQyxPQUFPRCxnRUFBZ0IsQ0FBQztJQUM1QkcsTUFBTUMsUUFBUUMsR0FBRyxDQUFDQyxVQUFVO0lBQzVCQyxNQUFNQyxTQUFTSixRQUFRQyxHQUFHLENBQUNJLFVBQVU7SUFDckNDLFVBQVVOLFFBQVFDLEdBQUcsQ0FBQ00sY0FBYztJQUNwQ0MsTUFBTVIsUUFBUUMsR0FBRyxDQUFDUSxVQUFVO0lBQzVCQyxVQUFVVixRQUFRQyxHQUFHLENBQUNVLGNBQWM7SUFDcENDLGlCQUFpQjtJQUNqQkMsb0JBQW9CO0lBQ3BCQyxZQUFZO0FBQ2Q7QUFFTyxlQUFlQyxNQUFNQyxHQUFHLEVBQUVDLE1BQU07SUFDckMsSUFBSTtRQUNGLE1BQU0sQ0FBQ0MsUUFBUSxHQUFHLE1BQU1yQixLQUFLa0IsS0FBSyxDQUFDQyxLQUFLQztRQUN4QyxPQUFPQztJQUNULEVBQUUsT0FBT0MsT0FBTztRQUNkQyxRQUFRRCxLQUFLLENBQUMseUJBQXlCQTtRQUN2QyxNQUFNQTtJQUNSO0FBQ0Y7QUFFQSxpRUFBZXRCLElBQUlBLEVBQUMiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly9uYXJzLy4vc3JjL3V0aWxzL2RiLmpzP2QzODQiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IG15c3FsIGZyb20gJ215c3FsMi9wcm9taXNlJztcclxuXHJcbmNvbnN0IHBvb2wgPSBteXNxbC5jcmVhdGVQb29sKHtcclxuICBob3N0OiBwcm9jZXNzLmVudi5NWVNRTF9IT1NULFxyXG4gIHBvcnQ6IHBhcnNlSW50KHByb2Nlc3MuZW52Lk1ZU1FMX1BPUlQpLFxyXG4gIGRhdGFiYXNlOiBwcm9jZXNzLmVudi5NWVNRTF9EQVRBQkFTRSxcclxuICB1c2VyOiBwcm9jZXNzLmVudi5NWVNRTF9VU0VSLFxyXG4gIHBhc3N3b3JkOiBwcm9jZXNzLmVudi5NWVNRTF9QQVNTV09SRCxcclxuICBjb25uZWN0aW9uTGltaXQ6IDEwLFxyXG4gIHdhaXRGb3JDb25uZWN0aW9uczogdHJ1ZSxcclxuICBxdWV1ZUxpbWl0OiAwXHJcbn0pO1xyXG5cclxuZXhwb3J0IGFzeW5jIGZ1bmN0aW9uIHF1ZXJ5KHNxbCwgdmFsdWVzKSB7XHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IFtyZXN1bHRzXSA9IGF3YWl0IHBvb2wucXVlcnkoc3FsLCB2YWx1ZXMpO1xyXG4gICAgcmV0dXJuIHJlc3VsdHM7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoJ0RhdGFiYXNlIHF1ZXJ5IGVycm9yOicsIGVycm9yKTtcclxuICAgIHRocm93IGVycm9yO1xyXG4gIH1cclxufVxyXG5cclxuZXhwb3J0IGRlZmF1bHQgcG9vbDsiXSwibmFtZXMiOlsibXlzcWwiLCJwb29sIiwiY3JlYXRlUG9vbCIsImhvc3QiLCJwcm9jZXNzIiwiZW52IiwiTVlTUUxfSE9TVCIsInBvcnQiLCJwYXJzZUludCIsIk1ZU1FMX1BPUlQiLCJkYXRhYmFzZSIsIk1ZU1FMX0RBVEFCQVNFIiwidXNlciIsIk1ZU1FMX1VTRVIiLCJwYXNzd29yZCIsIk1ZU1FMX1BBU1NXT1JEIiwiY29ubmVjdGlvbkxpbWl0Iiwid2FpdEZvckNvbm5lY3Rpb25zIiwicXVldWVMaW1pdCIsInF1ZXJ5Iiwic3FsIiwidmFsdWVzIiwicmVzdWx0cyIsImVycm9yIiwiY29uc29sZSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./src/utils/db.js\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(api)/./node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2F%5B...narsapi%5D&preferredRegion=&absolutePagePath=.%2Fsrc%5Cpages%5Capi%5C%5B...narsapi%5D.js&middlewareConfigBase64=e30%3D!")));
module.exports = __webpack_exports__;

})();